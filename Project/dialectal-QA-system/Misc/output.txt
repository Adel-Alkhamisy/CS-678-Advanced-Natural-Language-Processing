(py3) pankaj@mint:~/study/nlp/DialQA$ ./run.sh > output.log
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 02:22:01 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 02:22:07 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=0.3, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 02:22:07 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7778.67it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:36, 229.72it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<02:00, 212.34it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:41<00:53, 237.78it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:10<00:36, 183.81it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:40<00:00, 218.11it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 864150.83it/s]
12/06/2022 02:25:55 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 02:26:17 - INFO - __main__ -   ***** Running training *****
12/06/2022 02:26:17 - INFO - __main__ -     Num examples = 75700
12/06/2022 02:26:17 - INFO - __main__ -     Num Epochs = 3
12/06/2022 02:26:17 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 02:26:17 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 02:26:17 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 02:26:17 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:30<12:41,  5.56it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 02:27:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 02:27:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:29:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:08<11:16,  5.52it/s]
12/06/2022 02:29:34 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:31:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:46<09:43,  5.54it/s]
12/06/2022 02:31:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:32:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:25<08:13,  5.54it/s]
12/06/2022 02:32:51 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:34:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:04<06:50,  5.45it/s]
12/06/2022 02:34:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:36:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [09:43<05:13,  5.53it/s]
12/06/2022 02:36:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:37:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:22<03:43,  5.52it/s]
12/06/2022 02:37:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:39:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:01<02:13,  5.52it/s]
12/06/2022 02:39:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:41:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [14:40<00:42,  5.51it/s]
12/06/2022 02:41:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:30<00:00,  5.08it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:30<31:01, 930.84s/it12/06/2022 02:42:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:48<13:30,  5.51it/s]
12/06/2022 02:42:46 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:44:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:27<12:03,  5.48it/s]
12/06/2022 02:44:24 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:45:57 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:06<10:29,  5.51it/s]
12/06/2022 02:46:02 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:47:35 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:44<08:59,  5.50it/s]
12/06/2022 02:47:41 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:49:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:23<07:28,  5.50it/s]
12/06/2022 02:49:20 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:50:54 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:02<05:59,  5.47it/s]
12/06/2022 02:50:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:52:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:41<04:26,  5.51it/s]
12/06/2022 02:52:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:54:11 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:20<02:54,  5.53it/s]
12/06/2022 02:54:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:55:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [13:59<01:24,  5.54it/s]
12/06/2022 02:55:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:32<00:00,  5.08it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:02<15:31, 931.58s/it12/06/2022 02:57:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:07,  5.54it/s]
12/06/2022 02:57:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 02:59:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:44<12:37,  5.54it/s]
12/06/2022 02:59:14 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:00:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:23<11:08,  5.54it/s]
12/06/2022 03:00:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:02:27 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:02<09:37,  5.54it/s]
12/06/2022 03:02:33 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:04:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:42<08:07,  5.53it/s]
12/06/2022 03:04:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:05:44 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:21<06:36,  5.54it/s]
12/06/2022 03:05:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:07:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [09:59<05:06,  5.54it/s]
12/06/2022 03:07:29 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:09:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:38<03:36,  5.54it/s]
12/06/2022 03:09:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:10:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:17<02:06,  5.54it/s]
12/06/2022 03:10:46 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:12:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [14:56<00:35,  5.54it/s]
12/06/2022 03:12:25 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:39<00:00,  5.04it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [46:42<00:00, 934.20s/it]
12/06/2022 03:13:00 - INFO - __main__ -    global_step = 14197, average loss = 5.3055559925993725
12/06/2022 03:13:00 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 03:13:05 - INFO - __main__ -   Results:
12/06/2022 03:13:06 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 03:13:10 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=0.3, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 03:13:10 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 03:13:10 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 03:13:13 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 03:13:15 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 03:13:15 - INFO - __main__ -     Num examples = 6308
12/06/2022 03:13:15 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.45it/s]
12/06/2022 03:14:01 - INFO - __main__ -     Evaluation done in total 46.748198 secs (0.007411 sec per example)
12/06/2022 03:14:01 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 03:14:01 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 03:14:08 - INFO - __main__ -   Results:
12/06/2022 03:14:08 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.121867329917537), ('total', 2470), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.121867329917537), ('HasAns_total', 2470), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.121867329917537), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 1296), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 1296), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 2.0), ('f1', 3.248382352941177), ('total', 1000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.248382352941177), ('HasAns_total', 1000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.248382352941177), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 2.0), ('f1', 3.248382352941177), ('total', 1000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.248382352941177), ('HasAns_total', 1000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.248382352941177), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 2.0), ('f1', 3.2483823529411757), ('total', 2000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.2483823529411757), ('HasAns_total', 2000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.2483823529411757), ('best_f1_thresh', 0.0)])
12/06/2022 03:14:08 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 1.2833853624696496), ('f1', 2.6207282599165693), ('total', 5766), ('HasAns_exact', 1.2833853624696496), ('HasAns_f1', 2.6207282599165693), ('HasAns_total', 5766), ('best_exact', 1.2833853624696496), ('best_exact_thresh', 0.0), ('best_f1', 2.6207282599165693), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 03:14:09 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 03:14:15 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=0.003, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 03:14:15 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7787.77it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:38, 227.10it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:45<02:01, 210.35it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:43<00:54, 235.21it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:12<00:36, 182.36it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:43<00:00, 215.42it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 933991.39it/s]
12/06/2022 03:18:06 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 03:18:28 - INFO - __main__ -   ***** Running training *****
12/06/2022 03:18:28 - INFO - __main__ -     Num examples = 75700
12/06/2022 03:18:28 - INFO - __main__ -     Num Epochs = 3
12/06/2022 03:18:28 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 03:18:28 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 03:18:28 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 03:18:28 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:30<12:49,  5.50it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 03:20:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 03:20:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:21:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:09<11:18,  5.50it/s]
12/06/2022 03:21:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:23:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:49<09:48,  5.49it/s]
12/06/2022 03:23:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:25:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:29<08:17,  5.49it/s]
12/06/2022 03:25:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:26:40 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:08<06:46,  5.49it/s]
12/06/2022 03:26:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:28:18 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [09:47<05:15,  5.50it/s]
12/06/2022 03:28:24 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:29:58 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:26<03:44,  5.50it/s]
12/06/2022 03:30:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:31:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:06<02:13,  5.50it/s]
12/06/2022 03:31:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:33:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [14:45<00:42,  5.50it/s]
12/06/2022 03:33:22 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:35<00:00,  5.06it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:35<31:11, 935.90s/it12/06/2022 03:34:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:48<13:31,  5.50it/s]
12/06/2022 03:35:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:36:35 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:27<12:00,  5.50it/s]
12/06/2022 03:36:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:38:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:08<10:29,  5.51it/s]
12/06/2022 03:38:22 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:39:55 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:47<08:58,  5.51it/s]
12/06/2022 03:40:00 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:41:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:26<07:29,  5.49it/s]
12/06/2022 03:41:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:43:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:05<05:56,  5.51it/s]
12/06/2022 03:43:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:44:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:44<04:25,  5.51it/s]
12/06/2022 03:44:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:46:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:23<02:55,  5.51it/s]
12/06/2022 03:46:36 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:48:09 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:02<01:24,  5.53it/s]
12/06/2022 03:48:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:34<00:00,  5.06it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:10<15:35, 935.35s/it12/06/2022 03:49:48 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:10,  5.53it/s]
12/06/2022 03:49:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:51:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:46<12:40,  5.52it/s]
12/06/2022 03:51:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:53:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:25<11:08,  5.53it/s]
12/06/2022 03:53:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:54:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:03<09:38,  5.52it/s]
12/06/2022 03:54:52 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:56:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:42<08:07,  5.53it/s]
12/06/2022 03:56:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:58:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:21<06:38,  5.51it/s]
12/06/2022 03:58:10 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 03:59:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:00<05:07,  5.53it/s]
12/06/2022 03:59:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:01:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:39<03:36,  5.53it/s]
12/06/2022 04:01:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:03:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:18<02:06,  5.53it/s]
12/06/2022 04:03:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:04:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [14:57<00:35,  5.53it/s]
12/06/2022 04:04:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:42<00:00,  5.02it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [46:53<00:00, 937.94s/it]
12/06/2022 04:05:22 - INFO - __main__ -    global_step = 14197, average loss = 5.21795784168414
12/06/2022 04:05:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 04:05:28 - INFO - __main__ -   Results:
12/06/2022 04:05:29 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 04:05:33 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=0.003, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 04:05:33 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 04:05:33 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 04:05:36 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 04:05:37 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 04:05:37 - INFO - __main__ -     Num examples = 6308
12/06/2022 04:05:37 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.44it/s]
12/06/2022 04:06:24 - INFO - __main__ -     Evaluation done in total 46.791068 secs (0.007418 sec per example)
12/06/2022 04:06:24 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 04:06:24 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 04:06:31 - INFO - __main__ -   Results:
12/06/2022 04:06:31 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.1218673299175355), ('total', 494), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.1218673299175355), ('HasAns_total', 494), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.1218673299175355), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 1.214574898785425), ('f1', 3.121867329917537), ('total', 2470), ('HasAns_exact', 1.214574898785425), ('HasAns_f1', 3.121867329917537), ('HasAns_total', 2470), ('best_exact', 1.214574898785425), ('best_exact_thresh', 0.0), ('best_f1', 3.121867329917537), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 324), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 324), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 0.30864197530864196), ('f1', 0.6970232530094718), ('total', 1296), ('HasAns_exact', 0.30864197530864196), ('HasAns_f1', 0.6970232530094718), ('HasAns_total', 1296), ('best_exact', 0.30864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 0.6970232530094718), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 2.0), ('f1', 3.248382352941177), ('total', 1000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.248382352941177), ('HasAns_total', 1000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.248382352941177), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 2.0), ('f1', 3.248382352941177), ('total', 1000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.248382352941177), ('HasAns_total', 1000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.248382352941177), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 2.0), ('f1', 3.2483823529411757), ('total', 2000), ('HasAns_exact', 2.0), ('HasAns_f1', 3.2483823529411757), ('HasAns_total', 2000), ('best_exact', 2.0), ('best_exact_thresh', 0.0), ('best_f1', 3.2483823529411757), ('best_f1_thresh', 0.0)])
12/06/2022 04:06:31 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 1.2833853624696496), ('f1', 2.6207282599165693), ('total', 5766), ('HasAns_exact', 1.2833853624696496), ('HasAns_f1', 2.6207282599165693), ('HasAns_total', 5766), ('best_exact', 1.2833853624696496), ('best_exact_thresh', 0.0), ('best_f1', 2.6207282599165693), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 04:06:32 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 04:06:37 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 04:06:37 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7598.98it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:39, 225.92it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:45<02:02, 209.94it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:43<00:54, 234.49it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:12<00:36, 182.03it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:43<00:00, 215.15it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 901448.08it/s]
12/06/2022 04:10:29 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 04:10:51 - INFO - __main__ -   ***** Running training *****
12/06/2022 04:10:51 - INFO - __main__ -     Num examples = 75700
12/06/2022 04:10:51 - INFO - __main__ -     Num Epochs = 3
12/06/2022 04:10:51 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 04:10:51 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 04:10:51 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 04:10:51 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:31<13:03,  5.40it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 04:12:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 04:12:31 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:14:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:12<11:32,  5.39it/s]
12/06/2022 04:14:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:15:48 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:00,  5.39it/s]
12/06/2022 04:15:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:17:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:35<08:28,  5.38it/s]
12/06/2022 04:17:36 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:19:11 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:17<06:54,  5.39it/s]
12/06/2022 04:19:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:20:52 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [09:58<05:22,  5.38it/s]
12/06/2022 04:20:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:22:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:39<03:49,  5.38it/s]
12/06/2022 04:22:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:24:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:20<02:16,  5.38it/s]
12/06/2022 04:24:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:25:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:02<00:43,  5.38it/s]
12/06/2022 04:26:02 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:54<00:00,  4.96it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:54<31:48, 954.49s/it12/06/2022 04:27:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:49,  5.38it/s]
12/06/2022 04:27:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:29:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:30<12:16,  5.38it/s]
12/06/2022 04:29:25 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:31:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:12<10:43,  5.38it/s]
12/06/2022 04:31:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:32:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:54<09:10,  5.39it/s]
12/06/2022 04:32:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:34:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:36<07:37,  5.39it/s]
12/06/2022 04:34:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:36:05 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:17<06:04,  5.39it/s]
12/06/2022 04:36:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:37:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:58<04:31,  5.39it/s]
12/06/2022 04:37:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:39:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:40<02:58,  5.40it/s]
12/06/2022 04:39:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:41:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:21<01:26,  5.40it/s]
12/06/2022 04:41:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:56<00:00,  4.95it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:51<15:55, 955.88s/it12/06/2022 04:42:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:29,  5.40it/s]
12/06/2022 04:42:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:44:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:47<12:56,  5.41it/s]
12/06/2022 04:44:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:46:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:28<11:23,  5.41it/s]
12/06/2022 04:46:20 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:47:55 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:09<09:50,  5.41it/s]
12/06/2022 04:48:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:49:36 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:50<08:18,  5.41it/s]
12/06/2022 04:49:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:51:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:32<06:46,  5.41it/s]
12/06/2022 04:51:23 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:52:58 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:13<05:13,  5.41it/s]
12/06/2022 04:53:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:54:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:54<03:41,  5.41it/s]
12/06/2022 04:54:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:56:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:35<02:10,  5.36it/s]
12/06/2022 04:56:26 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 04:58:00 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:15<00:36,  5.40it/s]
12/06/2022 04:58:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:00<00:00,  4.92it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [47:52<00:00, 957.44s/it]
12/06/2022 04:58:43 - INFO - __main__ -    global_step = 14197, average loss = 0.6228907514593652
12/06/2022 04:58:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 04:58:49 - INFO - __main__ -   Results:
12/06/2022 04:58:50 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 04:58:54 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 04:58:54 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 04:58:54 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 04:58:56 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 04:58:58 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 04:58:58 - INFO - __main__ -     Num examples = 6308
12/06/2022 04:58:58 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.42it/s]
12/06/2022 04:59:45 - INFO - __main__ -     Evaluation done in total 46.913239 secs (0.007437 sec per example)
12/06/2022 04:59:45 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 04:59:45 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 04:59:57 - INFO - __main__ -   Results:
12/06/2022 04:59:57 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.88259109311741), ('f1', 73.32615516038116), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 73.32615516038116), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 73.32615516038116), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.07539148904485), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.07539148904485), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.07539148904485), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.05934189514919), ('total', 494), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.05934189514919), ('HasAns_total', 494), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.05934189514919), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.502024291497975), ('f1', 73.86401038374305), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 73.86401038374305), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 73.86401038374305), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 57.69230769230769), ('f1', 73.52360654907538), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 73.52360654907538), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 73.52360654907538), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 57.48987854251012), ('f1', 73.16970109547889), ('total', 2470), ('HasAns_exact', 57.48987854251012), ('HasAns_f1', 73.16970109547889), ('HasAns_total', 2470), ('best_exact', 57.48987854251012), ('best_exact_thresh', 0.0), ('best_f1', 73.16970109547889), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.90662408185608), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.90662408185608), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.90662408185608), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 58.02469135802469), ('f1', 72.89720082683125), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 72.89720082683125), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 72.89720082683125), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 59.5679012345679), ('f1', 75.01254976394475), ('total', 324), ('HasAns_exact', 59.5679012345679), ('HasAns_f1', 75.01254976394475), ('HasAns_total', 324), ('best_exact', 59.5679012345679), ('best_exact_thresh', 0.0), ('best_f1', 75.01254976394475), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 58.641975308641975), ('f1', 73.82167490347925), ('total', 324), ('HasAns_exact', 58.641975308641975), ('HasAns_f1', 73.82167490347925), ('HasAns_total', 324), ('best_exact', 58.641975308641975), ('best_exact_thresh', 0.0), ('best_f1', 73.82167490347925), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 58.333333333333336), ('f1', 73.65951239402774), ('total', 1296), ('HasAns_exact', 58.333333333333336), ('HasAns_f1', 73.65951239402774), ('HasAns_total', 1296), ('best_exact', 58.333333333333336), ('best_exact_thresh', 0.0), ('best_f1', 73.65951239402774), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.1), ('f1', 72.12308248610057), ('total', 1000), ('HasAns_exact', 64.1), ('HasAns_f1', 72.12308248610057), ('HasAns_total', 1000), ('best_exact', 64.1), ('best_exact_thresh', 0.0), ('best_f1', 72.12308248610057), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.9), ('f1', 71.01441512112982), ('total', 1000), ('HasAns_exact', 62.9), ('HasAns_f1', 71.01441512112982), ('HasAns_total', 1000), ('best_exact', 62.9), ('best_exact_thresh', 0.0), ('best_f1', 71.01441512112982), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.5), ('f1', 71.56874880361526), ('total', 2000), ('HasAns_exact', 63.5), ('HasAns_f1', 71.56874880361526), ('HasAns_total', 2000), ('best_exact', 63.5), ('best_exact_thresh', 0.0), ('best_f1', 71.56874880361526), ('best_f1_thresh', 0.0)])
12/06/2022 04:59:57 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.764134582032604), ('f1', 72.7244861907251), ('total', 5766), ('HasAns_exact', 59.764134582032604), ('HasAns_f1', 72.7244861907251), ('HasAns_total', 5766), ('best_exact', 59.764134582032604), ('best_exact_thresh', 0.0), ('best_f1', 72.7244861907251), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 04:59:58 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 05:00:04 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-07, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 05:00:04 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7738.25it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:38, 227.17it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:45<02:02, 210.05it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:42<00:54, 235.19it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:12<00:36, 182.16it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:42<00:00, 215.58it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 877569.31it/s]
12/06/2022 05:03:55 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 05:04:18 - INFO - __main__ -   ***** Running training *****
12/06/2022 05:04:18 - INFO - __main__ -     Num examples = 75700
12/06/2022 05:04:18 - INFO - __main__ -     Num Epochs = 3
12/06/2022 05:04:18 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 05:04:18 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 05:04:18 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 05:04:18 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:32<13:04,  5.39it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 05:05:52 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 05:05:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:07:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:13<11:31,  5.40it/s]
12/06/2022 05:07:41 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:09:16 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:55<10:01,  5.38it/s]
12/06/2022 05:09:22 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:10:57 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:37<08:28,  5.38it/s]
12/06/2022 05:11:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:12:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:18<06:55,  5.38it/s]
12/06/2022 05:12:46 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:14:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [10:00<05:22,  5.38it/s]
12/06/2022 05:14:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:16:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:42<03:49,  5.38it/s]
12/06/2022 05:16:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:17:44 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:23<02:16,  5.38it/s]
12/06/2022 05:17:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:19:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:05<00:43,  5.39it/s]
12/06/2022 05:19:32 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:57<00:00,  4.94it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:57<31:54, 957.24s/it12/06/2022 05:21:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:49,  5.39it/s]
12/06/2022 05:21:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:22:48 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:30<12:16,  5.38it/s]
12/06/2022 05:22:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:24:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:12<10:43,  5.39it/s]
12/06/2022 05:24:36 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:26:11 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:53<09:10,  5.38it/s]
12/06/2022 05:26:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:27:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:35<07:37,  5.39it/s]
12/06/2022 05:27:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:29:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:16<06:05,  5.39it/s]
12/06/2022 05:29:40 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:31:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:57<04:32,  5.39it/s]
12/06/2022 05:31:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:32:57 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:38<02:59,  5.39it/s]
12/06/2022 05:33:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:34:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:21<01:26,  5.40it/s]
12/06/2022 05:34:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:56<00:00,  4.95it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:53<15:56, 956.76s/it12/06/2022 05:36:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:30,  5.40it/s]
12/06/2022 05:36:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:38:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:47<12:56,  5.40it/s]
12/06/2022 05:38:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:39:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:29<11:24,  5.40it/s]
12/06/2022 05:39:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:41:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:09<09:52,  5.40it/s]
12/06/2022 05:41:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:43:05 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:50<08:19,  5.40it/s]
12/06/2022 05:43:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:44:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:31<06:46,  5.40it/s]
12/06/2022 05:44:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:46:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:14<05:14,  5.41it/s]
12/06/2022 05:46:34 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:48:09 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:55<03:41,  5.40it/s]
12/06/2022 05:48:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:49:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:36<02:09,  5.40it/s]
12/06/2022 05:49:56 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 05:51:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:17<00:36,  5.40it/s]
12/06/2022 05:51:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:02<00:00,  4.92it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [47:56<00:00, 958.67s/it]
12/06/2022 05:52:14 - INFO - __main__ -    global_step = 14197, average loss = 2.080061927564784
12/06/2022 05:52:14 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 05:52:18 - INFO - __main__ -   Results:
12/06/2022 05:52:19 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 05:52:24 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-07, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 05:52:24 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 05:52:24 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 05:52:26 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 05:52:28 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 05:52:28 - INFO - __main__ -     Num examples = 6308
12/06/2022 05:52:28 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.42it/s]
12/06/2022 05:53:15 - INFO - __main__ -     Evaluation done in total 46.940300 secs (0.007441 sec per example)
12/06/2022 05:53:15 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 05:53:15 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 05:53:27 - INFO - __main__ -   Results:
12/06/2022 05:53:27 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 35.4251012145749), ('f1', 49.69951248713343), ('total', 494), ('HasAns_exact', 35.4251012145749), ('HasAns_f1', 49.69951248713343), ('HasAns_total', 494), ('best_exact', 35.4251012145749), ('best_exact_thresh', 0.0), ('best_f1', 49.69951248713343), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 36.03238866396761), ('f1', 50.33622037768377), ('total', 494), ('HasAns_exact', 36.03238866396761), ('HasAns_f1', 50.33622037768377), ('HasAns_total', 494), ('best_exact', 36.03238866396761), ('best_exact_thresh', 0.0), ('best_f1', 50.33622037768377), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 33.80566801619433), ('f1', 47.24751282798581), ('total', 494), ('HasAns_exact', 33.80566801619433), ('HasAns_f1', 47.24751282798581), ('HasAns_total', 494), ('best_exact', 33.80566801619433), ('best_exact_thresh', 0.0), ('best_f1', 47.24751282798581), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 35.020242914979754), ('f1', 48.71914865703455), ('total', 494), ('HasAns_exact', 35.020242914979754), ('HasAns_f1', 48.71914865703455), ('HasAns_total', 494), ('best_exact', 35.020242914979754), ('best_exact_thresh', 0.0), ('best_f1', 48.71914865703455), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 35.22267206477733), ('f1', 49.299216571274336), ('total', 494), ('HasAns_exact', 35.22267206477733), ('HasAns_f1', 49.299216571274336), ('HasAns_total', 494), ('best_exact', 35.22267206477733), ('best_exact_thresh', 0.0), ('best_f1', 49.299216571274336), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 35.10121457489878), ('f1', 49.06032218422236), ('total', 2470), ('HasAns_exact', 35.10121457489878), ('HasAns_f1', 49.06032218422236), ('HasAns_total', 2470), ('best_exact', 35.10121457489878), ('best_exact_thresh', 0.0), ('best_f1', 49.06032218422236), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 35.49382716049383), ('f1', 54.66945124021482), ('total', 324), ('HasAns_exact', 35.49382716049383), ('HasAns_f1', 54.66945124021482), ('HasAns_total', 324), ('best_exact', 35.49382716049383), ('best_exact_thresh', 0.0), ('best_f1', 54.66945124021482), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 35.18518518518518), ('f1', 53.99520057571075), ('total', 324), ('HasAns_exact', 35.18518518518518), ('HasAns_f1', 53.99520057571075), ('HasAns_total', 324), ('best_exact', 35.18518518518518), ('best_exact_thresh', 0.0), ('best_f1', 53.99520057571075), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 35.49382716049383), ('f1', 54.99816316614896), ('total', 324), ('HasAns_exact', 35.49382716049383), ('HasAns_f1', 54.99816316614896), ('HasAns_total', 324), ('best_exact', 35.49382716049383), ('best_exact_thresh', 0.0), ('best_f1', 54.99816316614896), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 35.80246913580247), ('f1', 55.649607058333594), ('total', 324), ('HasAns_exact', 35.80246913580247), ('HasAns_f1', 55.649607058333594), ('HasAns_total', 324), ('best_exact', 35.80246913580247), ('best_exact_thresh', 0.0), ('best_f1', 55.649607058333594), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 35.49382716049383), ('f1', 54.82810551010195), ('total', 1296), ('HasAns_exact', 35.49382716049383), ('HasAns_f1', 54.82810551010195), ('HasAns_total', 1296), ('best_exact', 35.49382716049383), ('best_exact_thresh', 0.0), ('best_f1', 54.82810551010195), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 35.4), ('f1', 50.12123443969673), ('total', 1000), ('HasAns_exact', 35.4), ('HasAns_f1', 50.12123443969673), ('HasAns_total', 1000), ('best_exact', 35.4), ('best_exact_thresh', 0.0), ('best_f1', 50.12123443969673), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 36.2), ('f1', 50.637284867731466), ('total', 1000), ('HasAns_exact', 36.2), ('HasAns_f1', 50.637284867731466), ('HasAns_total', 1000), ('best_exact', 36.2), ('best_exact_thresh', 0.0), ('best_f1', 50.637284867731466), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 35.8), ('f1', 50.37925965371404), ('total', 2000), ('HasAns_exact', 35.8), ('HasAns_f1', 50.37925965371404), ('HasAns_total', 2000), ('best_exact', 35.8), ('best_exact_thresh', 0.0), ('best_f1', 50.37925965371404), ('best_f1_thresh', 0.0)])
12/06/2022 05:53:27 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 35.4318418314256), ('f1', 50.81421086429909), ('total', 5766), ('HasAns_exact', 35.4318418314256), ('HasAns_f1', 50.81421086429909), ('HasAns_total', 5766), ('best_exact', 35.4318418314256), ('best_exact_thresh', 0.0), ('best_f1', 50.81421086429909), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 05:53:27 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 05:53:33 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=1.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 05:53:33 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7797.56it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:55<02:36, 229.93it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<02:00, 212.30it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:40<00:53, 238.32it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:09<00:36, 185.11it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:39<00:00, 218.83it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 890450.34it/s]
12/06/2022 05:57:21 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 05:57:44 - INFO - __main__ -   ***** Running training *****
12/06/2022 05:57:44 - INFO - __main__ -     Num examples = 75700
12/06/2022 05:57:44 - INFO - __main__ -     Num Epochs = 1
12/06/2022 05:57:44 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 05:57:44 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 05:57:44 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 05:57:44 - INFO - __main__ -     Total optimization steps = 4732
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/1 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:32<13:04,  5.40it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 05:59:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 05:59:25 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:01:00 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:12<11:33,  5.38it/s]
12/06/2022 06:01:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:02:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:01,  5.38it/s]
12/06/2022 06:02:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:04:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:36<08:28,  5.38it/s]
12/06/2022 06:04:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:06:05 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:17<06:55,  5.38it/s]
12/06/2022 06:06:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:07:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [10:00<05:22,  5.37it/s]
12/06/2022 06:07:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:09:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:42<03:49,  5.38it/s]
12/06/2022 06:09:34 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:11:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:22<02:16,  5.38it/s]
12/06/2022 06:11:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:12:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:04<00:43,  5.39it/s]
12/06/2022 06:12:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:56<00:00,  4.95it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [15:56<00:00, 956.85s/it]
12/06/2022 06:13:41 - INFO - __main__ -    global_step = 4733, average loss = 0.9353490491595828
12/06/2022 06:13:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 06:13:46 - INFO - __main__ -   Results:
12/06/2022 06:13:47 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 06:13:52 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=1.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 06:13:52 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 06:13:52 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 06:13:54 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 06:13:56 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 06:13:56 - INFO - __main__ -     Num examples = 6308
12/06/2022 06:13:56 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:47<00:00,  8.39it/s]
12/06/2022 06:14:43 - INFO - __main__ -     Evaluation done in total 47.108016 secs (0.007468 sec per example)
12/06/2022 06:14:43 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 06:14:43 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 06:14:55 - INFO - __main__ -   Results:
12/06/2022 06:14:55 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.2753036437247), ('f1', 72.27751657791478), ('total', 494), ('HasAns_exact', 56.2753036437247), ('HasAns_f1', 72.27751657791478), ('HasAns_total', 494), ('best_exact', 56.2753036437247), ('best_exact_thresh', 0.0), ('best_f1', 72.27751657791478), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 56.477732793522264), ('f1', 72.48882791298304), ('total', 494), ('HasAns_exact', 56.477732793522264), ('HasAns_f1', 72.48882791298304), ('HasAns_total', 494), ('best_exact', 56.477732793522264), ('best_exact_thresh', 0.0), ('best_f1', 72.48882791298304), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 53.84615384615385), ('f1', 69.72171120840946), ('total', 494), ('HasAns_exact', 53.84615384615385), ('HasAns_f1', 69.72171120840946), ('HasAns_total', 494), ('best_exact', 53.84615384615385), ('best_exact_thresh', 0.0), ('best_f1', 69.72171120840946), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 57.08502024291498), ('f1', 72.38813921611057), ('total', 494), ('HasAns_exact', 57.08502024291498), ('HasAns_f1', 72.38813921611057), ('HasAns_total', 494), ('best_exact', 57.08502024291498), ('best_exact_thresh', 0.0), ('best_f1', 72.38813921611057), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 55.66801619433198), ('f1', 71.12935872988601), ('total', 494), ('HasAns_exact', 55.66801619433198), ('HasAns_f1', 71.12935872988601), ('HasAns_total', 494), ('best_exact', 55.66801619433198), ('best_exact_thresh', 0.0), ('best_f1', 71.12935872988601), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.6011107290609), ('total', 2470), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.6011107290609), ('HasAns_total', 2470), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.6011107290609), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 55.864197530864196), ('f1', 72.49567281981852), ('total', 324), ('HasAns_exact', 55.864197530864196), ('HasAns_f1', 72.49567281981852), ('HasAns_total', 324), ('best_exact', 55.864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 72.49567281981852), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 56.17283950617284), ('f1', 72.6305191084369), ('total', 324), ('HasAns_exact', 56.17283950617284), ('HasAns_f1', 72.6305191084369), ('HasAns_total', 324), ('best_exact', 56.17283950617284), ('best_exact_thresh', 0.0), ('best_f1', 72.6305191084369), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 58.02469135802469), ('f1', 74.26826187432765), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 74.26826187432765), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 74.26826187432765), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 56.79012345679013), ('f1', 73.41595601471184), ('total', 324), ('HasAns_exact', 56.79012345679013), ('HasAns_f1', 73.41595601471184), ('HasAns_total', 324), ('best_exact', 56.79012345679013), ('best_exact_thresh', 0.0), ('best_f1', 73.41595601471184), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 56.71296296296296), ('f1', 73.20260245432364), ('total', 1296), ('HasAns_exact', 56.71296296296296), ('HasAns_f1', 73.20260245432364), ('HasAns_total', 1296), ('best_exact', 56.71296296296296), ('best_exact_thresh', 0.0), ('best_f1', 73.20260245432364), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 61.7), ('f1', 70.83107496126311), ('total', 1000), ('HasAns_exact', 61.7), ('HasAns_f1', 70.83107496126311), ('HasAns_total', 1000), ('best_exact', 61.7), ('best_exact_thresh', 0.0), ('best_f1', 70.83107496126311), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 60.9), ('f1', 69.44895797240993), ('total', 1000), ('HasAns_exact', 60.9), ('HasAns_f1', 69.44895797240993), ('HasAns_total', 1000), ('best_exact', 60.9), ('best_exact_thresh', 0.0), ('best_f1', 69.44895797240993), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 61.3), ('f1', 70.14001646683654), ('total', 2000), ('HasAns_exact', 61.3), ('HasAns_f1', 70.14001646683654), ('HasAns_total', 2000), ('best_exact', 61.3), ('best_exact_thresh', 0.0), ('best_f1', 70.14001646683654), ('best_f1_thresh', 0.0)])
12/06/2022 06:14:55 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 57.94311481096081), ('f1', 71.45427492460193), ('total', 5766), ('HasAns_exact', 57.94311481096081), ('HasAns_f1', 71.45427492460193), ('HasAns_total', 5766), ('best_exact', 57.94311481096081), ('best_exact_thresh', 0.0), ('best_f1', 71.45427492460193), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 06:14:56 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 06:15:00 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 06:15:00 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7888.11it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:55<02:36, 230.82it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<02:00, 212.89it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:40<00:53, 237.83it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:09<00:36, 184.84it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:39<00:00, 218.85it/s]
add example index and unique id: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 1067233.66it/s]
12/06/2022 06:18:48 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 06:19:12 - INFO - __main__ -   ***** Running training *****
12/06/2022 06:19:12 - INFO - __main__ -     Num examples = 75700
12/06/2022 06:19:12 - INFO - __main__ -     Num Epochs = 3
12/06/2022 06:19:12 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 06:19:12 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 06:19:12 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 06:19:12 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:31<13:03,  5.40it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 06:20:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 06:20:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:22:27 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:13<11:33,  5.39it/s]
12/06/2022 06:22:33 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:24:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:00,  5.38it/s]
12/06/2022 06:24:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:25:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:35<08:27,  5.38it/s]
12/06/2022 06:25:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:27:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:17<06:55,  5.38it/s]
12/06/2022 06:27:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:29:14 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [09:59<05:22,  5.38it/s]
12/06/2022 06:29:19 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:30:54 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:40<03:49,  5.38it/s]
12/06/2022 06:31:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:32:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:23<02:16,  5.38it/s]
12/06/2022 06:32:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:34:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:05<00:43,  5.38it/s]
12/06/2022 06:34:26 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:57<00:00,  4.94it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:57<31:55, 957.98s/it12/06/2022 06:36:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:50,  5.38it/s]
12/06/2022 06:36:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:37:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:30<12:17,  5.38it/s]
12/06/2022 06:37:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:39:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:11<10:43,  5.38it/s]
12/06/2022 06:39:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:41:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:53<09:11,  5.38it/s]
12/06/2022 06:41:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:42:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:35<07:38,  5.38it/s]
12/06/2022 06:42:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:44:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:16<06:04,  5.39it/s]
12/06/2022 06:44:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:46:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:58<04:32,  5.38it/s]
12/06/2022 06:46:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:47:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:39<02:59,  5.39it/s]
12/06/2022 06:47:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:49:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:21<01:26,  5.40it/s]
12/06/2022 06:49:40 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:56<00:00,  4.95it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:54<15:57, 957.17s/it12/06/2022 06:51:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:30,  5.40it/s]
12/06/2022 06:51:22 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:52:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:48<12:56,  5.41it/s]
12/06/2022 06:53:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:54:37 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:29<11:24,  5.40it/s]
12/06/2022 06:54:43 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:56:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:09<09:51,  5.40it/s]
12/06/2022 06:56:23 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:57:58 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:49<08:20,  5.39it/s]
12/06/2022 06:58:05 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 06:59:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:30<06:46,  5.40it/s]
12/06/2022 06:59:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:01:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:11<05:14,  5.40it/s]
12/06/2022 07:01:26 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:03:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:52<03:41,  5.40it/s]
12/06/2022 07:03:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:04:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:33<02:09,  5.40it/s]
12/06/2022 07:04:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:06:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:15<00:36,  5.40it/s]
12/06/2022 07:06:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:59<00:00,  4.93it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [47:54<00:00, 958.13s/it]
12/06/2022 07:07:06 - INFO - __main__ -    global_step = 14197, average loss = 0.6228907514593652
12/06/2022 07:07:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 07:07:11 - INFO - __main__ -   Results:
12/06/2022 07:07:12 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 07:07:16 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 07:07:16 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 07:07:16 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 07:07:19 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 07:07:20 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 07:07:20 - INFO - __main__ -     Num examples = 6308
12/06/2022 07:07:20 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.41it/s]
12/06/2022 07:08:07 - INFO - __main__ -     Evaluation done in total 46.966752 secs (0.007446 sec per example)
12/06/2022 07:08:07 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 07:08:07 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 07:08:19 - INFO - __main__ -   Results:
12/06/2022 07:08:19 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.88259109311741), ('f1', 73.32615516038116), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 73.32615516038116), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 73.32615516038116), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.07539148904485), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.07539148904485), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.07539148904485), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.05934189514919), ('total', 494), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.05934189514919), ('HasAns_total', 494), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.05934189514919), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.502024291497975), ('f1', 73.86401038374305), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 73.86401038374305), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 73.86401038374305), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 57.69230769230769), ('f1', 73.52360654907538), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 73.52360654907538), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 73.52360654907538), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 57.48987854251012), ('f1', 73.16970109547889), ('total', 2470), ('HasAns_exact', 57.48987854251012), ('HasAns_f1', 73.16970109547889), ('HasAns_total', 2470), ('best_exact', 57.48987854251012), ('best_exact_thresh', 0.0), ('best_f1', 73.16970109547889), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.90662408185608), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.90662408185608), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.90662408185608), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 58.02469135802469), ('f1', 72.89720082683125), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 72.89720082683125), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 72.89720082683125), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 59.5679012345679), ('f1', 75.01254976394475), ('total', 324), ('HasAns_exact', 59.5679012345679), ('HasAns_f1', 75.01254976394475), ('HasAns_total', 324), ('best_exact', 59.5679012345679), ('best_exact_thresh', 0.0), ('best_f1', 75.01254976394475), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 58.641975308641975), ('f1', 73.82167490347925), ('total', 324), ('HasAns_exact', 58.641975308641975), ('HasAns_f1', 73.82167490347925), ('HasAns_total', 324), ('best_exact', 58.641975308641975), ('best_exact_thresh', 0.0), ('best_f1', 73.82167490347925), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 58.333333333333336), ('f1', 73.65951239402774), ('total', 1296), ('HasAns_exact', 58.333333333333336), ('HasAns_f1', 73.65951239402774), ('HasAns_total', 1296), ('best_exact', 58.333333333333336), ('best_exact_thresh', 0.0), ('best_f1', 73.65951239402774), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.1), ('f1', 72.12308248610057), ('total', 1000), ('HasAns_exact', 64.1), ('HasAns_f1', 72.12308248610057), ('HasAns_total', 1000), ('best_exact', 64.1), ('best_exact_thresh', 0.0), ('best_f1', 72.12308248610057), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.9), ('f1', 71.01441512112982), ('total', 1000), ('HasAns_exact', 62.9), ('HasAns_f1', 71.01441512112982), ('HasAns_total', 1000), ('best_exact', 62.9), ('best_exact_thresh', 0.0), ('best_f1', 71.01441512112982), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.5), ('f1', 71.56874880361526), ('total', 2000), ('HasAns_exact', 63.5), ('HasAns_f1', 71.56874880361526), ('HasAns_total', 2000), ('best_exact', 63.5), ('best_exact_thresh', 0.0), ('best_f1', 71.56874880361526), ('best_f1_thresh', 0.0)])
12/06/2022 07:08:19 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.764134582032604), ('f1', 72.7244861907251), ('total', 5766), ('HasAns_exact', 59.764134582032604), ('HasAns_f1', 72.7244861907251), ('HasAns_total', 5766), ('best_exact', 59.764134582032604), ('best_exact_thresh', 0.0), ('best_f1', 72.7244861907251), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 07:08:20 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 07:08:26 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=5.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 07:08:26 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7587.37it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:55<02:36, 230.68it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<01:59, 214.25it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:39<00:53, 241.65it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:08<00:35, 187.38it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:38<00:00, 220.24it/s]
add example index and unique id: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 1056550.19it/s]
12/06/2022 07:12:12 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 07:12:34 - INFO - __main__ -   ***** Running training *****
12/06/2022 07:12:34 - INFO - __main__ -     Num examples = 75700
12/06/2022 07:12:34 - INFO - __main__ -     Num Epochs = 5
12/06/2022 07:12:34 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 07:12:34 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 07:12:34 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 07:12:34 - INFO - __main__ -     Total optimization steps = 23660
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/5 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:32<13:05,  5.39it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 07:14:09 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 07:14:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:15:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:13<11:32,  5.39it/s]
12/06/2022 07:15:56 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:17:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:01,  5.38it/s]
12/06/2022 07:17:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:19:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:36<08:28,  5.38it/s]
12/06/2022 07:19:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:20:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:19<06:55,  5.38it/s]
12/06/2022 07:21:02 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:22:37 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [10:00<05:22,  5.38it/s]
12/06/2022 07:22:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:24:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:42<03:49,  5.38it/s]
12/06/2022 07:24:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:26:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:24<02:16,  5.37it/s]
12/06/2022 07:26:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:27:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:06<00:43,  5.37it/s]
12/06/2022 07:27:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:57<00:00,  4.94it/s]
Epoch:  20%|██████████████████████████████████████████████████████▌                                                                                                                                                                                                                          | 1/5 [15:57<1:03:50, 957.73s/it12/06/2022 07:29:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:49,  5.39it/s]
12/06/2022 07:29:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:31:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:30<12:17,  5.38it/s]
12/06/2022 07:31:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:32:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:12<10:44,  5.38it/s]
12/06/2022 07:32:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:34:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:53<09:11,  5.38it/s]
12/06/2022 07:34:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:36:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:35<07:38,  5.38it/s]
12/06/2022 07:36:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:37:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:16<06:05,  5.38it/s]
12/06/2022 07:37:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:39:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:57<04:32,  5.39it/s]
12/06/2022 07:39:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:41:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:38<02:59,  5.39it/s]
12/06/2022 07:41:19 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:42:54 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:19<01:26,  5.39it/s]
12/06/2022 07:43:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:55<00:00,  4.95it/s]
Epoch:  40%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                     | 2/5 [31:52<47:48, 956.19s/it12/06/2022 07:44:36 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:30,  5.40it/s]
12/06/2022 07:44:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:46:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:47<12:57,  5.40it/s]
12/06/2022 07:46:23 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:47:58 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:27<11:25,  5.40it/s]
12/06/2022 07:48:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:49:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:09<09:52,  5.40it/s]
12/06/2022 07:49:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:51:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:50<08:19,  5.40it/s]
12/06/2022 07:51:26 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:53:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:31<06:46,  5.40it/s]
12/06/2022 07:53:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:54:44 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:14<05:14,  5.40it/s]
12/06/2022 07:54:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:56:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:54<03:42,  5.39it/s]
12/06/2022 07:56:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:58:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:35<02:09,  5.40it/s]
12/06/2022 07:58:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 07:59:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:16<00:36,  5.39it/s]
12/06/2022 07:59:52 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:00<00:00,  4.92it/s]
Epoch:  60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                              | 3/5 [47:53<31:56, 958.37s/it12/06/2022 08:01:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500                                                                                                           | 302/4732 [00:55<13:40,  5.40it/s]
12/06/2022 08:01:33 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:03:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000                                                                                                           | 802/4732 [02:37<12:08,  5.40it/s]
12/06/2022 08:03:14 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:04:49 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500                                                                                                          | 1302/4732 [04:18<10:35,  5.40it/s]
12/06/2022 08:04:56 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:06:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000                                                                                                          | 1802/4732 [05:59<09:02,  5.40it/s]
12/06/2022 08:06:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:08:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500                                                                                                          | 2302/4732 [07:40<07:30,  5.40it/s]
12/06/2022 08:08:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:09:52 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000                                                                                                          | 2802/4732 [09:21<05:57,  5.39it/s]
12/06/2022 08:09:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:11:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500█████████████████████████▌                                                                                | 3302/4732 [11:02<04:25,  5.40it/s]
12/06/2022 08:11:40 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:13:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000█████████████████████████████████████████████████████▋                                                    | 3802/4732 [12:44<02:52,  5.40it/s]
12/06/2022 08:13:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:14:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500█████████████████████████████████████████████████████████████████████████████████▊                        | 4302/4732 [14:25<01:19,  5.39it/s]
12/06/2022 08:15:02 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:52<00:00,  4.97it/s]
Epoch:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 4/5 [1:03:46<15:56, 956.23s/it12/06/2022 08:16:36 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000                                                                                                            | 70/4732 [00:12<14:24,  5.39it/s]
12/06/2022 08:16:43 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:18:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500                                                                                                           | 570/4732 [01:53<12:51,  5.40it/s]
12/06/2022 08:18:24 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:19:59 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000                                                                                                          | 1070/4732 [03:35<11:17,  5.40it/s]
12/06/2022 08:20:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:21:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500                                                                                                          | 1570/4732 [05:15<09:46,  5.40it/s]
12/06/2022 08:21:46 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:23:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000                                                                                                          | 2070/4732 [06:56<08:13,  5.39it/s]
12/06/2022 08:23:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:25:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500                                                                                                          | 2570/4732 [08:37<06:40,  5.39it/s]
12/06/2022 08:25:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:26:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000████████████▌                                                                                             | 3070/4732 [10:18<05:07,  5.40it/s]
12/06/2022 08:26:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:28:24 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500████████████████████████████████████████▋                                                                 | 3570/4732 [11:59<03:35,  5.40it/s]
12/06/2022 08:28:31 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:30:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000████████████████████████████████████████████████████████████████████▊                                     | 4070/4732 [13:42<02:02,  5.40it/s]
12/06/2022 08:30:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:31:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500████████████████████████████████████████████████████████████████████████████████████████████████▉         | 4570/4732 [15:23<00:30,  5.39it/s]
12/06/2022 08:31:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:01<00:00,  4.92it/s]
Epoch: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [1:19:48<00:00, 957.61s/it]
12/06/2022 08:32:23 - INFO - __main__ -    global_step = 23661, average loss = 0.46319534489343267
12/06/2022 08:32:23 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 08:32:28 - INFO - __main__ -   Results:
12/06/2022 08:32:29 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 08:32:33 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=5.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 08:32:33 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 08:32:33 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 08:32:35 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 08:32:37 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 08:32:37 - INFO - __main__ -     Num examples = 6308
12/06/2022 08:32:37 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.41it/s]
12/06/2022 08:33:24 - INFO - __main__ -     Evaluation done in total 46.981205 secs (0.007448 sec per example)
12/06/2022 08:33:24 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 08:33:24 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 08:33:36 - INFO - __main__ -   Results:
12/06/2022 08:33:36 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 55.465587044534416), ('f1', 70.4435848905494), ('total', 494), ('HasAns_exact', 55.465587044534416), ('HasAns_f1', 70.4435848905494), ('HasAns_total', 494), ('best_exact', 55.465587044534416), ('best_exact_thresh', 0.0), ('best_f1', 70.4435848905494), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 56.2753036437247), ('f1', 71.63984926495142), ('total', 494), ('HasAns_exact', 56.2753036437247), ('HasAns_f1', 71.63984926495142), ('HasAns_total', 494), ('best_exact', 56.2753036437247), ('best_exact_thresh', 0.0), ('best_f1', 71.63984926495142), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 53.036437246963565), ('f1', 68.22884820859447), ('total', 494), ('HasAns_exact', 53.036437246963565), ('HasAns_f1', 68.22884820859447), ('HasAns_total', 494), ('best_exact', 53.036437246963565), ('best_exact_thresh', 0.0), ('best_f1', 68.22884820859447), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 56.88259109311741), ('f1', 71.50282058941414), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 71.50282058941414), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 71.50282058941414), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 54.8582995951417), ('f1', 70.39644383526411), ('total', 494), ('HasAns_exact', 54.8582995951417), ('HasAns_f1', 70.39644383526411), ('HasAns_total', 494), ('best_exact', 54.8582995951417), ('best_exact_thresh', 0.0), ('best_f1', 70.39644383526411), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 55.30364372469636), ('f1', 70.44230935775485), ('total', 2470), ('HasAns_exact', 55.30364372469636), ('HasAns_f1', 70.44230935775485), ('HasAns_total', 2470), ('best_exact', 55.30364372469636), ('best_exact_thresh', 0.0), ('best_f1', 70.44230935775485), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 53.08641975308642), ('f1', 70.51597787707308), ('total', 324), ('HasAns_exact', 53.08641975308642), ('HasAns_f1', 70.51597787707308), ('HasAns_total', 324), ('best_exact', 53.08641975308642), ('best_exact_thresh', 0.0), ('best_f1', 70.51597787707308), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 54.32098765432099), ('f1', 70.5899030377697), ('total', 324), ('HasAns_exact', 54.32098765432099), ('HasAns_f1', 70.5899030377697), ('HasAns_total', 324), ('best_exact', 54.32098765432099), ('best_exact_thresh', 0.0), ('best_f1', 70.5899030377697), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 55.864197530864196), ('f1', 72.42677997635701), ('total', 324), ('HasAns_exact', 55.864197530864196), ('HasAns_f1', 72.42677997635701), ('HasAns_total', 324), ('best_exact', 55.864197530864196), ('best_exact_thresh', 0.0), ('best_f1', 72.42677997635701), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 55.55555555555556), ('f1', 71.96542251207556), ('total', 324), ('HasAns_exact', 55.55555555555556), ('HasAns_f1', 71.96542251207556), ('HasAns_total', 324), ('best_exact', 55.55555555555556), ('best_exact_thresh', 0.0), ('best_f1', 71.96542251207556), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 54.70679012345679), ('f1', 71.37452085081874), ('total', 1296), ('HasAns_exact', 54.70679012345679), ('HasAns_f1', 71.37452085081874), ('HasAns_total', 1296), ('best_exact', 54.70679012345679), ('best_exact_thresh', 0.0), ('best_f1', 71.37452085081874), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 63.4), ('f1', 72.4109063554866), ('total', 1000), ('HasAns_exact', 63.4), ('HasAns_f1', 72.4109063554866), ('HasAns_total', 1000), ('best_exact', 63.4), ('best_exact_thresh', 0.0), ('best_f1', 72.4109063554866), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.5), ('f1', 70.60221490892158), ('total', 1000), ('HasAns_exact', 62.5), ('HasAns_f1', 70.60221490892158), ('HasAns_total', 1000), ('best_exact', 62.5), ('best_exact_thresh', 0.0), ('best_f1', 70.60221490892158), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 62.95), ('f1', 71.5065606322041), ('total', 2000), ('HasAns_exact', 62.95), ('HasAns_f1', 71.5065606322041), ('HasAns_total', 2000), ('best_exact', 62.95), ('best_exact_thresh', 0.0), ('best_f1', 71.5065606322041), ('best_f1_thresh', 0.0)])
12/06/2022 08:33:36 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 57.82171349288935), ('f1', 71.02098584820011), ('total', 5766), ('HasAns_exact', 57.82171349288935), ('HasAns_f1', 71.02098584820011), ('HasAns_total', 5766), ('best_exact', 57.82171349288935), ('best_exact_thresh', 0.0), ('best_f1', 71.02098584820011), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 08:33:36 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 08:33:42 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=7.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 08:33:42 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7914.83it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:37, 229.54it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<01:59, 214.18it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:40<00:53, 239.15it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:09<00:36, 185.72it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:39<00:00, 218.70it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 954804.95it/s]
12/06/2022 08:37:29 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 08:37:52 - INFO - __main__ -   ***** Running training *****
12/06/2022 08:37:52 - INFO - __main__ -     Num examples = 75700
12/06/2022 08:37:52 - INFO - __main__ -     Num Epochs = 7
12/06/2022 08:37:52 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 08:37:52 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 08:37:52 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 08:37:52 - INFO - __main__ -     Total optimization steps = 33124
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/7 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:32<13:05,  5.39it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 08:39:27 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 08:39:32 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:41:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:12<11:31,  5.40it/s]
12/06/2022 08:41:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:42:48 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:01,  5.38it/s]
12/06/2022 08:42:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:44:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:35<08:28,  5.38it/s]
12/06/2022 08:44:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:46:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:17<06:55,  5.37it/s]
12/06/2022 08:46:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:47:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [09:58<05:22,  5.37it/s]
12/06/2022 08:47:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:49:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:39<03:49,  5.38it/s]
12/06/2022 08:49:40 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:51:16 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:21<02:16,  5.38it/s]
12/06/2022 08:51:22 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:52:57 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:02<00:43,  5.38it/s]
12/06/2022 08:53:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:54<00:00,  4.96it/s]
Epoch:  14%|███████████████████████████████████████                                                                                                                                                                                                                                          | 1/7 [15:54<1:35:27, 954.65s/it12/06/2022 08:54:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:50,  5.38it/s]
12/06/2022 08:54:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:56:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:32<12:17,  5.38it/s]
12/06/2022 08:56:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:58:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:14<10:44,  5.38it/s]
12/06/2022 08:58:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 08:59:44 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:55<09:11,  5.38it/s]
12/06/2022 08:59:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:01:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:36<07:37,  5.39it/s]
12/06/2022 09:01:31 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:03:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:17<06:05,  5.38it/s]
12/06/2022 09:03:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:04:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:57<04:32,  5.38it/s]
12/06/2022 09:04:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:06:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:39<02:59,  5.39it/s]
12/06/2022 09:06:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:08:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:21<01:26,  5.39it/s]
12/06/2022 09:08:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:55<00:00,  4.95it/s]
Epoch:  29%|██████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                                   | 2/7 [31:50<1:19:35, 955.15s/it12/06/2022 09:09:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:30,  5.40it/s]
12/06/2022 09:09:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:11:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:47<12:57,  5.40it/s]
12/06/2022 09:11:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:13:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:28<11:25,  5.40it/s]
12/06/2022 09:13:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:14:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:08<09:52,  5.40it/s]
12/06/2022 09:14:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:16:34 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:49<08:19,  5.40it/s]
12/06/2022 09:16:41 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:18:16 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:31<06:47,  5.40it/s]
12/06/2022 09:18:23 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:19:57 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:12<05:14,  5.40it/s]
12/06/2022 09:20:04 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:21:39 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:54<03:41,  5.40it/s]
12/06/2022 09:21:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:23:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:37<02:09,  5.40it/s]
12/06/2022 09:23:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:25:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:18<00:36,  5.39it/s]
12/06/2022 09:25:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:03<00:00,  4.91it/s]
Epoch:  43%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                            | 3/7 [47:53<1:03:55, 958.80s/it12/06/2022 09:26:44 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500                                                                                                           | 302/4732 [00:55<13:41,  5.39it/s]
12/06/2022 09:26:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:28:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000                                                                                                           | 802/4732 [02:37<12:07,  5.40it/s]
12/06/2022 09:28:31 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:30:06 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500                                                                                                          | 1302/4732 [04:18<10:34,  5.40it/s]
12/06/2022 09:30:12 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:31:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000                                                                                                          | 1802/4732 [05:59<09:02,  5.40it/s]
12/06/2022 09:31:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:33:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500                                                                                                          | 2302/4732 [07:40<07:30,  5.40it/s]
12/06/2022 09:33:33 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:35:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000                                                                                                          | 2802/4732 [09:20<05:57,  5.40it/s]
12/06/2022 09:35:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:36:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500█████████████████████████▌                                                                                | 3302/4732 [11:01<04:24,  5.40it/s]
12/06/2022 09:36:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:38:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000█████████████████████████████████████████████████████▋                                                    | 3802/4732 [12:44<02:52,  5.40it/s]
12/06/2022 09:38:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:40:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500█████████████████████████████████████████████████████████████████████████████████▊                        | 4302/4732 [14:24<01:19,  5.40it/s]
12/06/2022 09:40:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:52<00:00,  4.97it/s]
Epoch:  57%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                     | 4/7 [1:03:45<47:49, 956.39s/it12/06/2022 09:41:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000                                                                                                            | 70/4732 [00:12<14:23,  5.40it/s]
12/06/2022 09:41:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:43:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500                                                                                                           | 570/4732 [01:53<12:51,  5.40it/s]
12/06/2022 09:43:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:45:14 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000                                                                                                          | 1070/4732 [03:34<11:19,  5.39it/s]
12/06/2022 09:45:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:46:55 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500                                                                                                          | 1570/4732 [05:15<09:46,  5.39it/s]
12/06/2022 09:47:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:48:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000                                                                                                          | 2070/4732 [06:57<08:13,  5.39it/s]
12/06/2022 09:48:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:50:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500                                                                                                          | 2570/4732 [08:38<06:40,  5.40it/s]
12/06/2022 09:50:25 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:51:59 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000████████████▌                                                                                             | 3070/4732 [10:19<05:07,  5.40it/s]
12/06/2022 09:52:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:53:40 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500████████████████████████████████████████▋                                                                 | 3570/4732 [12:00<03:35,  5.40it/s]
12/06/2022 09:53:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:55:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000████████████████████████████████████████████████████████████████████▊                                     | 4070/4732 [13:41<02:02,  5.39it/s]
12/06/2022 09:55:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000
                                                                                                                                                                                                                                                                                                                             12/06/2022 09:57:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500████████████████████████████████████████████████████████████████████████████████████████████████▉         | 4570/4732 [15:22<00:29,  5.42it/s]
12/06/2022 09:57:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:00<00:00,  4.92it/s]
Epoch:  71%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                              | 5/7 [1:19:46<31:56, 958.04s/it12/06/2022 09:58:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24000                                                                                                           | 338/4732 [01:02<13:33,  5.40it/s]
12/06/2022 09:58:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:00:23 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24500                                                                                                           | 838/4732 [02:42<12:01,  5.40it/s]
12/06/2022 10:00:30 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:02:05 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25000                                                                                                          | 1338/4732 [04:23<10:29,  5.39it/s]
12/06/2022 10:02:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:03:45 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25500                                                                                                          | 1838/4732 [06:04<08:56,  5.40it/s]
12/06/2022 10:03:51 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:05:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26000                                                                                                          | 2338/4732 [07:44<07:22,  5.42it/s]
12/06/2022 10:05:32 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:07:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26500                                                                                                          | 2838/4732 [09:25<05:51,  5.39it/s]
12/06/2022 10:07:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:08:47 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27000███████████████████████████▋                                                                              | 3338/4732 [11:06<04:18,  5.40it/s]
12/06/2022 10:08:53 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:10:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27500███████████████████████████████████████████████████████▋                                                  | 3838/4732 [12:47<02:45,  5.40it/s]
12/06/2022 10:10:34 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:12:08 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28000███████████████████████████████████████████████████████████████████████████████████▊                      | 4338/4732 [14:27<01:12,  5.40it/s]
12/06/2022 10:12:14 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:48<00:00,  4.99it/s]
Epoch:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                       | 6/7 [1:35:35<15:54, 954.74s/it12/06/2022 10:13:49 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28500                                                                                                           | 106/4732 [00:19<14:13,  5.42it/s]
12/06/2022 10:13:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:15:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-29000                                                                                                           | 606/4732 [02:00<12:44,  5.40it/s]
12/06/2022 10:15:36 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-29000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:17:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-29500                                                                                                          | 1106/4732 [03:41<11:07,  5.43it/s]
12/06/2022 10:17:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-29500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:18:52 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-30000                                                                                                          | 1606/4732 [05:22<09:36,  5.42it/s]
12/06/2022 10:18:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-30000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:20:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-30500                                                                                                          | 2106/4732 [07:02<08:06,  5.39it/s]
12/06/2022 10:20:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-30500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:22:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-31000                                                                                                          | 2606/4732 [08:43<06:31,  5.43it/s]
12/06/2022 10:22:20 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-31000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:23:54 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-31500██████████████▌                                                                                           | 3106/4732 [10:25<05:01,  5.40it/s]
12/06/2022 10:24:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-31500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:25:35 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-32000██████████████████████████████████████████▋                                                               | 3606/4732 [12:05<03:28,  5.40it/s]
12/06/2022 10:25:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-32000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:27:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-32500██████████████████████████████████████████████████████████████████████▊                                   | 4106/4732 [13:46<01:55,  5.40it/s]
12/06/2022 10:27:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-32500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:28:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-33000██████████████████████████████████████████████████████████████████████████████████████████████████▉       | 4606/4732 [15:26<00:22,  5.49it/s]
12/06/2022 10:29:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-33000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:58<00:00,  4.94it/s]
Epoch: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [1:51:33<00:00, 956.27s/it]
12/06/2022 10:29:26 - INFO - __main__ -    global_step = 33125, average loss = 0.3707366272547379
12/06/2022 10:29:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 10:29:30 - INFO - __main__ -   Results:
12/06/2022 10:29:31 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 10:29:36 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=7.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 10:29:36 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 10:29:36 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 10:29:39 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 10:29:40 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 10:29:40 - INFO - __main__ -     Num examples = 6308
12/06/2022 10:29:40 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.41it/s]
12/06/2022 10:30:27 - INFO - __main__ -     Evaluation done in total 46.978957 secs (0.007448 sec per example)
12/06/2022 10:30:27 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 10:30:27 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 10:30:39 - INFO - __main__ -   Results:
12/06/2022 10:30:39 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.072874493927124), ('f1', 72.01944935288242), ('total', 494), ('HasAns_exact', 56.072874493927124), ('HasAns_f1', 72.01944935288242), ('HasAns_total', 494), ('best_exact', 56.072874493927124), ('best_exact_thresh', 0.0), ('best_f1', 72.01944935288242), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 56.477732793522264), ('f1', 72.9164427003208), ('total', 494), ('HasAns_exact', 56.477732793522264), ('HasAns_f1', 72.9164427003208), ('HasAns_total', 494), ('best_exact', 56.477732793522264), ('best_exact_thresh', 0.0), ('best_f1', 72.9164427003208), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 53.84615384615385), ('f1', 69.61727790883027), ('total', 494), ('HasAns_exact', 53.84615384615385), ('HasAns_f1', 69.61727790883027), ('HasAns_total', 494), ('best_exact', 53.84615384615385), ('best_exact_thresh', 0.0), ('best_f1', 69.61727790883027), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 56.072874493927124), ('f1', 72.43160219185312), ('total', 494), ('HasAns_exact', 56.072874493927124), ('HasAns_f1', 72.43160219185312), ('HasAns_total', 494), ('best_exact', 56.072874493927124), ('best_exact_thresh', 0.0), ('best_f1', 72.43160219185312), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 56.072874493927124), ('f1', 72.3302999087657), ('total', 494), ('HasAns_exact', 56.072874493927124), ('HasAns_f1', 72.3302999087657), ('HasAns_total', 494), ('best_exact', 56.072874493927124), ('best_exact_thresh', 0.0), ('best_f1', 72.3302999087657), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 55.7085020242915), ('f1', 71.86301441253067), ('total', 2470), ('HasAns_exact', 55.7085020242915), ('HasAns_f1', 71.86301441253067), ('HasAns_total', 2470), ('best_exact', 55.7085020242915), ('best_exact_thresh', 0.0), ('best_f1', 71.86301441253067), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 52.46913580246913), ('f1', 69.78164447623398), ('total', 324), ('HasAns_exact', 52.46913580246913), ('HasAns_f1', 69.78164447623398), ('HasAns_total', 324), ('best_exact', 52.46913580246913), ('best_exact_thresh', 0.0), ('best_f1', 69.78164447623398), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 53.7037037037037), ('f1', 70.76993292860155), ('total', 324), ('HasAns_exact', 53.7037037037037), ('HasAns_f1', 70.76993292860155), ('HasAns_total', 324), ('best_exact', 53.7037037037037), ('best_exact_thresh', 0.0), ('best_f1', 70.76993292860155), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 55.55555555555556), ('f1', 72.63119906956797), ('total', 324), ('HasAns_exact', 55.55555555555556), ('HasAns_f1', 72.63119906956797), ('HasAns_total', 324), ('best_exact', 55.55555555555556), ('best_exact_thresh', 0.0), ('best_f1', 72.63119906956797), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 54.93827160493827), ('f1', 72.3392924542036), ('total', 324), ('HasAns_exact', 54.93827160493827), ('HasAns_f1', 72.3392924542036), ('HasAns_total', 324), ('best_exact', 54.93827160493827), ('best_exact_thresh', 0.0), ('best_f1', 72.3392924542036), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 54.166666666666664), ('f1', 71.38051723215172), ('total', 1296), ('HasAns_exact', 54.166666666666664), ('HasAns_f1', 71.38051723215172), ('HasAns_total', 1296), ('best_exact', 54.166666666666664), ('best_exact_thresh', 0.0), ('best_f1', 71.38051723215172), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.0), ('f1', 72.63094917349143), ('total', 1000), ('HasAns_exact', 64.0), ('HasAns_f1', 72.63094917349143), ('HasAns_total', 1000), ('best_exact', 64.0), ('best_exact_thresh', 0.0), ('best_f1', 72.63094917349143), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 61.4), ('f1', 69.42042756609989), ('total', 1000), ('HasAns_exact', 61.4), ('HasAns_f1', 69.42042756609989), ('HasAns_total', 1000), ('best_exact', 61.4), ('best_exact_thresh', 0.0), ('best_f1', 69.42042756609989), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 62.7), ('f1', 71.02568836979573), ('total', 2000), ('HasAns_exact', 62.7), ('HasAns_f1', 71.02568836979573), ('HasAns_total', 2000), ('best_exact', 62.7), ('best_exact_thresh', 0.0), ('best_f1', 71.02568836979573), ('best_f1_thresh', 0.0)])
12/06/2022 10:30:39 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 57.787027402011795), ('f1', 71.46412984242248), ('total', 5766), ('HasAns_exact', 57.787027402011795), ('HasAns_f1', 71.46412984242248), ('HasAns_total', 5766), ('best_exact', 57.787027402011795), ('best_exact_thresh', 0.0), ('best_f1', 71.46412984242248), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 10:30:40 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 10:30:45 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=8, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 10:30:45 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7737.00it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:36, 229.94it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:43<02:00, 212.12it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:41<00:53, 238.62it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:10<00:36, 184.91it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:40<00:00, 218.30it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 908832.36it/s]
12/06/2022 10:34:33 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 10:34:57 - INFO - __main__ -   ***** Running training *****
12/06/2022 10:34:57 - INFO - __main__ -     Num examples = 75700
12/06/2022 10:34:57 - INFO - __main__ -     Num Epochs = 3
12/06/2022 10:34:57 - INFO - __main__ -     Instantaneous batch size per GPU = 8
12/06/2022 10:34:57 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 8
12/06/2022 10:34:57 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 10:34:57 - INFO - __main__ -     Total optimization steps = 28389
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/9463 [01:01<18:28,  8.09it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 10:36:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 10:36:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:37:11 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/9463 [02:12<17:28,  8.07it/s]
12/06/2022 10:37:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:38:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/9463 [03:22<16:25,  8.08it/s]
12/06/2022 10:38:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:39:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/9463 [04:32<15:23,  8.08it/s]
12/06/2022 10:39:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:40:43 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/9463 [05:44<14:22,  8.08it/s]
12/06/2022 10:40:50 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:41:55 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000                                                                                                           | 2998/9463 [06:54<13:19,  8.08it/s]
12/06/2022 10:42:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:43:05 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500                                                                                                           | 3498/9463 [08:05<12:18,  8.08it/s]
12/06/2022 10:43:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:44:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000                                                                                                           | 3998/9463 [09:15<11:16,  8.08it/s]
12/06/2022 10:44:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:45:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500                                                                                                           | 4498/9463 [10:26<10:14,  8.08it/s]
12/06/2022 10:45:32 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:46:36 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                           | 4998/9463 [11:36<09:11,  8.09it/s]
12/06/2022 10:46:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:47:46 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                           | 5498/9463 [12:46<08:10,  8.09it/s]
12/06/2022 10:47:52 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:48:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000█████████▌                                                                                                 | 5998/9463 [13:57<07:08,  8.08it/s]
12/06/2022 10:49:03 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:50:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500███████████████████████▋                                                                                   | 6498/9463 [15:07<06:06,  8.10it/s]
12/06/2022 10:50:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:51:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000█████████████████████████████████████▋                                                                     | 6998/9463 [16:18<05:04,  8.08it/s]
12/06/2022 10:51:24 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:52:28 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500███████████████████████████████████████████████████▊                                                       | 7498/9463 [17:28<04:03,  8.08it/s]
12/06/2022 10:52:34 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:53:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000█████████████████████████████████████████████████████████████████▊                                         | 7998/9463 [18:39<03:00,  8.10it/s]
12/06/2022 10:53:45 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:54:49 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500███████████████████████████████████████████████████████████████████████████████▊                           | 8498/9463 [19:49<01:59,  8.10it/s]
12/06/2022 10:54:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:55:59 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000█████████████████████████████████████████████████████████████████████████████████████████████▉             | 8998/9463 [20:59<00:57,  8.11it/s]
12/06/2022 10:56:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9463/9463 [22:06<00:00,  7.14it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                      | 1/3 [22:06<44:12, 1326.07s/it12/06/2022 10:57:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 35/9463 [00:04<19:20,  8.12it/s]
12/06/2022 10:57:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:58:20 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 535/9463 [01:14<18:18,  8.12it/s]
12/06/2022 10:58:27 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 10:59:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1035/9463 [02:25<17:17,  8.12it/s]
12/06/2022 10:59:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:00:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1535/9463 [03:35<16:15,  8.12it/s]
12/06/2022 11:00:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:01:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2035/9463 [04:45<15:14,  8.12it/s]
12/06/2022 11:01:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:03:01 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2535/9463 [05:55<14:12,  8.12it/s]
12/06/2022 11:03:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:04:11 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500                                                                                                          | 3035/9463 [07:05<13:10,  8.13it/s]
12/06/2022 11:04:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:05:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000                                                                                                          | 3535/9463 [08:15<12:08,  8.14it/s]
12/06/2022 11:05:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:06:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500                                                                                                          | 4035/9463 [09:26<11:08,  8.12it/s]
12/06/2022 11:06:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:07:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000                                                                                                          | 4535/9463 [10:36<10:06,  8.13it/s]
12/06/2022 11:07:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:08:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500                                                                                                          | 5035/9463 [11:47<09:05,  8.12it/s]
12/06/2022 11:08:59 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:10:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000                                                                                                          | 5535/9463 [12:57<08:02,  8.14it/s]
12/06/2022 11:10:11 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:11:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500█████████▋                                                                                                | 6035/9463 [14:09<07:02,  8.12it/s]
12/06/2022 11:11:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-15500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:12:25 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000███████████████████████▋                                                                                  | 6535/9463 [15:19<06:00,  8.12it/s]
12/06/2022 11:12:31 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:13:35 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500█████████████████████████████████████▊                                                                    | 7035/9463 [16:29<04:58,  8.12it/s]
12/06/2022 11:13:41 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-16500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:14:45 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000███████████████████████████████████████████████████▊                                                      | 7535/9463 [17:39<03:56,  8.14it/s]
12/06/2022 11:14:55 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:15:58 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500█████████████████████████████████████████████████████████████████▊                                        | 8035/9463 [18:53<02:56,  8.11it/s]
12/06/2022 11:16:05 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-17500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:17:09 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000███████████████████████████████████████████████████████████████████████████████▉                          | 8535/9463 [20:03<01:54,  8.12it/s]
12/06/2022 11:17:15 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:18:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500█████████████████████████████████████████████████████████████████████████████████████████████▉            | 9035/9463 [21:13<00:52,  8.12it/s]
12/06/2022 11:18:26 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-18500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9463/9463 [22:15<00:00,  7.09it/s]
Epoch:  67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 2/3 [44:21<22:11, 1331.47s/it12/06/2022 11:19:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000                                                                                                            | 72/9463 [00:08<19:16,  8.12it/s]
12/06/2022 11:19:36 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:20:40 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500                                                                                                           | 572/9463 [01:19<18:17,  8.10it/s]
12/06/2022 11:20:46 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-19500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:21:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000                                                                                                          | 1072/9463 [02:29<17:09,  8.15it/s]
12/06/2022 11:21:56 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:23:00 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500                                                                                                          | 1572/9463 [03:39<16:11,  8.13it/s]
12/06/2022 11:23:06 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-20500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:24:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000                                                                                                          | 2072/9463 [04:49<15:10,  8.12it/s]
12/06/2022 11:24:17 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:25:21 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500                                                                                                          | 2572/9463 [05:59<14:09,  8.12it/s]
12/06/2022 11:25:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-21500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:26:31 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000                                                                                                          | 3072/9463 [07:10<13:01,  8.17it/s]
12/06/2022 11:26:37 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:27:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500                                                                                                          | 3572/9463 [08:20<12:03,  8.14it/s]
12/06/2022 11:27:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-22500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:28:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000                                                                                                          | 4072/9463 [09:30<11:03,  8.13it/s]
12/06/2022 11:28:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:30:02 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500                                                                                                          | 4572/9463 [10:41<10:02,  8.11it/s]
12/06/2022 11:30:08 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-23500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:31:12 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24000                                                                                                          | 5072/9463 [11:51<09:00,  8.12it/s]
12/06/2022 11:31:18 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:32:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24500                                                                                                          | 5572/9463 [13:01<07:58,  8.13it/s]
12/06/2022 11:32:29 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-24500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:33:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25000██████████▋                                                                                               | 6072/9463 [14:11<06:56,  8.15it/s]
12/06/2022 11:33:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:34:42 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25500████████████████████████▋                                                                                 | 6572/9463 [15:21<05:55,  8.13it/s]
12/06/2022 11:34:49 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-25500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:35:53 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26000██████████████████████████████████████▊                                                                   | 7072/9463 [16:32<04:53,  8.14it/s]
12/06/2022 11:36:00 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:37:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26500████████████████████████████████████████████████████▊                                                     | 7572/9463 [17:42<03:53,  8.11it/s]
12/06/2022 11:37:10 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-26500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:38:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27000██████████████████████████████████████████████████████████████████▉                                       | 8072/9463 [18:53<02:50,  8.17it/s]
12/06/2022 11:38:20 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:39:23 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27500████████████████████████████████████████████████████████████████████████████████▉                         | 8572/9463 [20:02<01:49,  8.15it/s]
12/06/2022 11:39:29 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-27500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:40:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28000███████████████████████████████████████████████████████████████████████████████████████████████           | 9072/9463 [21:12<00:48,  8.13it/s]
12/06/2022 11:40:39 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-28000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9463/9463 [22:08<00:00,  7.12it/s]
Epoch: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [1:06:29<00:00, 1329.99s/it]
12/06/2022 11:41:27 - INFO - __main__ -    global_step = 28390, average loss = 0.642210518163807
12/06/2022 11:41:27 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 11:41:32 - INFO - __main__ -   Results:
12/06/2022 11:41:33 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 11:41:37 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=8, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 11:41:37 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 11:41:37 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 11:41:40 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 11:41:41 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 11:41:41 - INFO - __main__ -     Num examples = 6308
12/06/2022 11:41:41 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.43it/s]
12/06/2022 11:42:28 - INFO - __main__ -     Evaluation done in total 46.860891 secs (0.007429 sec per example)
12/06/2022 11:42:28 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 11:42:28 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 11:42:40 - INFO - __main__ -   Results:
12/06/2022 11:42:40 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 58.097165991902834), ('f1', 74.06475905210327), ('total', 494), ('HasAns_exact', 58.097165991902834), ('HasAns_f1', 74.06475905210327), ('HasAns_total', 494), ('best_exact', 58.097165991902834), ('best_exact_thresh', 0.0), ('best_f1', 74.06475905210327), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 57.69230769230769), ('f1', 74.01580252939617), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 74.01580252939617), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 74.01580252939617), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 56.88259109311741), ('f1', 72.02116505834513), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 72.02116505834513), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 72.02116505834513), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.906882591093115), ('f1', 73.95723459686702), ('total', 494), ('HasAns_exact', 58.906882591093115), ('HasAns_f1', 73.95723459686702), ('HasAns_total', 494), ('best_exact', 58.906882591093115), ('best_exact_thresh', 0.0), ('best_f1', 73.95723459686702), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.5943611139493), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.5943611139493), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.5943611139493), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 58.016194331983804), ('f1', 73.73066447013231), ('total', 2470), ('HasAns_exact', 58.016194331983804), ('HasAns_f1', 73.73066447013231), ('HasAns_total', 2470), ('best_exact', 58.016194331983804), ('best_exact_thresh', 0.0), ('best_f1', 73.73066447013231), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 54.32098765432099), ('f1', 70.27544557491319), ('total', 324), ('HasAns_exact', 54.32098765432099), ('HasAns_f1', 70.27544557491319), ('HasAns_total', 324), ('best_exact', 54.32098765432099), ('best_exact_thresh', 0.0), ('best_f1', 70.27544557491319), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 56.48148148148148), ('f1', 71.50222803043675), ('total', 324), ('HasAns_exact', 56.48148148148148), ('HasAns_f1', 71.50222803043675), ('HasAns_total', 324), ('best_exact', 56.48148148148148), ('best_exact_thresh', 0.0), ('best_f1', 71.50222803043675), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 56.79012345679013), ('f1', 72.11847989729779), ('total', 324), ('HasAns_exact', 56.79012345679013), ('HasAns_f1', 72.11847989729779), ('HasAns_total', 324), ('best_exact', 56.79012345679013), ('best_exact_thresh', 0.0), ('best_f1', 72.11847989729779), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.07964572591003), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.07964572591003), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.07964572591003), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 56.17283950617284), ('f1', 71.49394980713936), ('total', 1296), ('HasAns_exact', 56.17283950617284), ('HasAns_f1', 71.49394980713936), ('HasAns_total', 1296), ('best_exact', 56.17283950617284), ('best_exact_thresh', 0.0), ('best_f1', 71.49394980713936), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.3), ('f1', 73.12387313426254), ('total', 1000), ('HasAns_exact', 64.3), ('HasAns_f1', 73.12387313426254), ('HasAns_total', 1000), ('best_exact', 64.3), ('best_exact_thresh', 0.0), ('best_f1', 73.12387313426254), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 61.7), ('f1', 69.90974480213887), ('total', 1000), ('HasAns_exact', 61.7), ('HasAns_f1', 69.90974480213887), ('HasAns_total', 1000), ('best_exact', 61.7), ('best_exact_thresh', 0.0), ('best_f1', 69.90974480213887), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.0), ('f1', 71.51680896820079), ('total', 2000), ('HasAns_exact', 63.0), ('HasAns_f1', 71.51680896820079), ('HasAns_total', 2000), ('best_exact', 63.0), ('best_exact_thresh', 0.0), ('best_f1', 71.51680896820079), ('best_f1_thresh', 0.0)])
12/06/2022 11:42:40 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.33055844606313), ('f1', 72.46002742415534), ('total', 5766), ('HasAns_exact', 59.33055844606313), ('HasAns_f1', 72.46002742415534), ('HasAns_total', 5766), ('best_exact', 59.33055844606313), ('best_exact_thresh', 0.0), ('best_f1', 72.46002742415534), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 11:42:41 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 11:42:46 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=16, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 11:42:46 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7680.62it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:55<02:35, 232.44it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:42<01:59, 214.82it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:39<00:53, 239.42it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:07<00:36, 185.94it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:37<00:00, 220.72it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 915626.92it/s]
12/06/2022 11:46:32 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 11:46:54 - INFO - __main__ -   ***** Running training *****
12/06/2022 11:46:54 - INFO - __main__ -     Num examples = 75700
12/06/2022 11:46:54 - INFO - __main__ -     Num Epochs = 3
12/06/2022 11:46:54 - INFO - __main__ -     Instantaneous batch size per GPU = 16
12/06/2022 11:46:54 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 16
12/06/2022 11:46:54 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 11:46:54 - INFO - __main__ -     Total optimization steps = 14196
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.                                                                                             | 498/4732 [01:32<13:04,  5.39it/s]
  warnings.warn("To get the last learning rate computed by the scheduler, "
12/06/2022 11:48:29 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
12/06/2022 11:48:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:50:10 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000                                                                                                            | 998/4732 [03:13<11:31,  5.40it/s]
12/06/2022 11:50:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:51:51 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500                                                                                                           | 1498/4732 [04:54<10:01,  5.38it/s]
12/06/2022 11:51:58 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-1500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:53:33 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000                                                                                                           | 1998/4732 [06:36<08:28,  5.38it/s]
12/06/2022 11:53:40 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:55:15 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500                                                                                                           | 2498/4732 [08:18<06:55,  5.38it/s]
12/06/2022 11:55:21 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-2500
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:56:56 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000█████████▌                                                                                                 | 2998/4732 [10:00<05:22,  5.38it/s]
12/06/2022 11:57:02 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3000
                                                                                                                                                                                                                                                                                                                             12/06/2022 11:58:38 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500█████████████████████████████████████▋                                                                     | 3498/4732 [11:41<03:49,  5.38it/s]
12/06/2022 11:58:44 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-3500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:00:19 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000█████████████████████████████████████████████████████████████████▋                                         | 3998/4732 [13:22<02:16,  5.38it/s]
12/06/2022 12:00:25 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:02:00 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500█████████████████████████████████████████████████████████████████████████████████████████████▊             | 4498/4732 [15:03<00:43,  5.38it/s]
12/06/2022 12:02:07 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-4500
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:55<00:00,  4.95it/s]
Epoch:  33%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                       | 1/3 [15:55<31:51, 955.64s/it12/06/2022 12:03:41 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000                                                                                                            | 266/4732 [00:49<13:50,  5.38it/s]
12/06/2022 12:03:48 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:05:23 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500                                                                                                            | 766/4732 [02:31<12:16,  5.38it/s]
12/06/2022 12:05:29 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-5500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:07:04 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000                                                                                                           | 1266/4732 [04:12<10:43,  5.38it/s]
12/06/2022 12:07:10 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:08:45 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500                                                                                                           | 1766/4732 [05:53<09:10,  5.39it/s]
12/06/2022 12:08:51 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-6500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:10:26 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000                                                                                                           | 2266/4732 [07:34<07:37,  5.39it/s]
12/06/2022 12:10:32 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:12:07 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500                                                                                                           | 2766/4732 [09:15<06:05,  5.39it/s]
12/06/2022 12:12:13 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-7500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:13:48 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000████████████████████████▌                                                                                  | 3266/4732 [10:56<04:32,  5.38it/s]
12/06/2022 12:13:54 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:15:30 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500████████████████████████████████████████████████████▋                                                      | 3766/4732 [12:36<02:59,  5.40it/s]
12/06/2022 12:15:35 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-8500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:17:09 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000████████████████████████████████████████████████████████████████████████████████▊                          | 4266/4732 [14:18<01:26,  5.40it/s]
12/06/2022 12:17:16 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [15:52<00:00,  4.97it/s]
Epoch:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 2/3 [31:47<15:53, 953.51s/it12/06/2022 12:18:50 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500                                                                                                             | 34/4732 [00:06<14:30,  5.40it/s]
12/06/2022 12:18:57 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-9500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:20:32 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000                                                                                                           | 534/4732 [01:47<12:57,  5.40it/s]
12/06/2022 12:20:38 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:22:13 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500                                                                                                          | 1034/4732 [03:28<11:26,  5.39it/s]
12/06/2022 12:22:19 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-10500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:23:55 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000                                                                                                          | 1534/4732 [05:10<09:53,  5.39it/s]
12/06/2022 12:24:01 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:25:36 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500                                                                                                          | 2034/4732 [06:51<08:21,  5.38it/s]
12/06/2022 12:25:42 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-11500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:27:17 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000                                                                                                          | 2534/4732 [08:33<06:48,  5.38it/s]
12/06/2022 12:27:24 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:28:59 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500██████████▌                                                                                               | 3034/4732 [10:14<05:15,  5.38it/s]
12/06/2022 12:29:05 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-12500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:30:40 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000██████████████████████████████████████▋                                                                   | 3534/4732 [11:56<03:42,  5.37it/s]
12/06/2022 12:30:47 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13000
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:32:22 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500██████████████████████████████████████████████████████████████████▊                                       | 4034/4732 [13:37<02:09,  5.38it/s]
12/06/2022 12:32:28 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-13500
                                                                                                                                                                                                                                                                                                                             12/06/2022 12:34:03 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000██████████████████████████████████████████████████████████████████████████████████████████████▊           | 4534/4732 [15:19<00:36,  5.38it/s]
12/06/2022 12:34:09 - INFO - __main__ -   Saving optimizer and scheduler states to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/checkpoint-14000
Iteration: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4732/4732 [16:03<00:00,  4.91it/s]
Epoch: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [47:51<00:00, 957.16s/it]
12/06/2022 12:34:45 - INFO - __main__ -    global_step = 14197, average loss = 0.6228907514593652
12/06/2022 12:34:45 - INFO - __main__ -   Saving model checkpoint to /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/
12/06/2022 12:34:50 - INFO - __main__ -   Results:
12/06/2022 12:34:51 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 12:34:55 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=16, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 12:34:55 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 12:34:55 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 12:34:58 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 12:35:00 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 12:35:00 - INFO - __main__ -     Num examples = 6308
12/06/2022 12:35:00 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:47<00:00,  8.38it/s]
12/06/2022 12:35:47 - INFO - __main__ -     Evaluation done in total 47.141183 secs (0.007473 sec per example)
12/06/2022 12:35:47 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 12:35:47 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 12:35:58 - INFO - __main__ -   Results:
12/06/2022 12:35:58 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.88259109311741), ('f1', 73.32615516038116), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 73.32615516038116), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 73.32615516038116), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:58 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.07539148904485), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.07539148904485), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.07539148904485), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:58 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.05934189514919), ('total', 494), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.05934189514919), ('HasAns_total', 494), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.05934189514919), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.502024291497975), ('f1', 73.86401038374305), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 73.86401038374305), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 73.86401038374305), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 57.69230769230769), ('f1', 73.52360654907538), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 73.52360654907538), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 73.52360654907538), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 57.48987854251012), ('f1', 73.16970109547889), ('total', 2470), ('HasAns_exact', 57.48987854251012), ('HasAns_f1', 73.16970109547889), ('HasAns_total', 2470), ('best_exact', 57.48987854251012), ('best_exact_thresh', 0.0), ('best_f1', 73.16970109547889), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.90662408185608), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.90662408185608), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.90662408185608), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 58.02469135802469), ('f1', 72.89720082683125), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 72.89720082683125), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 72.89720082683125), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 59.5679012345679), ('f1', 75.01254976394475), ('total', 324), ('HasAns_exact', 59.5679012345679), ('HasAns_f1', 75.01254976394475), ('HasAns_total', 324), ('best_exact', 59.5679012345679), ('best_exact_thresh', 0.0), ('best_f1', 75.01254976394475), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 58.641975308641975), ('f1', 73.82167490347925), ('total', 324), ('HasAns_exact', 58.641975308641975), ('HasAns_f1', 73.82167490347925), ('HasAns_total', 324), ('best_exact', 58.641975308641975), ('best_exact_thresh', 0.0), ('best_f1', 73.82167490347925), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 58.333333333333336), ('f1', 73.65951239402774), ('total', 1296), ('HasAns_exact', 58.333333333333336), ('HasAns_f1', 73.65951239402774), ('HasAns_total', 1296), ('best_exact', 58.333333333333336), ('best_exact_thresh', 0.0), ('best_f1', 73.65951239402774), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.1), ('f1', 72.12308248610057), ('total', 1000), ('HasAns_exact', 64.1), ('HasAns_f1', 72.12308248610057), ('HasAns_total', 1000), ('best_exact', 64.1), ('best_exact_thresh', 0.0), ('best_f1', 72.12308248610057), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.9), ('f1', 71.01441512112982), ('total', 1000), ('HasAns_exact', 62.9), ('HasAns_f1', 71.01441512112982), ('HasAns_total', 1000), ('best_exact', 62.9), ('best_exact_thresh', 0.0), ('best_f1', 71.01441512112982), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.5), ('f1', 71.56874880361526), ('total', 2000), ('HasAns_exact', 63.5), ('HasAns_f1', 71.56874880361526), ('HasAns_total', 2000), ('best_exact', 63.5), ('best_exact_thresh', 0.0), ('best_f1', 71.56874880361526), ('best_f1_thresh', 0.0)])
12/06/2022 12:35:59 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.764134582032604), ('f1', 72.7244861907251), ('total', 5766), ('HasAns_exact', 59.764134582032604), ('HasAns_f1', 72.7244861907251), ('HasAns_total', 5766), ('best_exact', 59.764134582032604), ('best_exact_thresh', 0.0), ('best_f1', 72.7244861907251), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 12:35:59 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 12:36:05 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=24, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 12:36:05 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7621.34it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:57<02:40, 224.48it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:46<02:03, 207.64it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:43<00:54, 237.27it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:13<00:36, 182.80it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:43<00:00, 215.09it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 886858.12it/s]
12/06/2022 12:39:56 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 12:40:21 - INFO - __main__ -   ***** Running training *****
12/06/2022 12:40:21 - INFO - __main__ -     Num examples = 75700
12/06/2022 12:40:21 - INFO - __main__ -     Num Epochs = 3
12/06/2022 12:40:21 - INFO - __main__ -     Instantaneous batch size per GPU = 24
12/06/2022 12:40:21 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 24
12/06/2022 12:40:21 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 12:40:21 - INFO - __main__ -     Total optimization steps = 9465
Iteration:   0%|                                                                                                                                                                                                                                                                             | 1/3155 [00:00<35:10,  1.49it/s]
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "src/run_squad.py", line 856, in <module>
    main()
  File "src/run_squad.py", line 797, in main
    global_step, tr_loss = train(args, train_dataset, model, tokenizer)
  File "src/run_squad.py", line 202, in train
    outputs = model(**inputs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 1612, in forward
    return_dict=return_dict,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 841, in forward
    return_dict=return_dict,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 482, in forward
    output_attentions,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 423, in forward
    self.feed_forward_chunk, self.chunk_size_feed_forward, self.seq_len_dim, attention_output
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_utils.py", line 1696, in apply_chunking_to_forward
    return forward_fn(*input_tensors)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 429, in feed_forward_chunk
    intermediate_output = self.intermediate(attention_output)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 357, in forward
    hidden_states = self.intermediate_act_fn(hidden_states)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/functional.py", line 1459, in gelu
    return torch._C._nn.gelu(input)
RuntimeError: CUDA out of memory. Tried to allocate 52.00 MiB (GPU 0; 7.77 GiB total capacity; 5.74 GiB already allocated; 15.62 MiB free; 5.95 GiB reserved in total by PyTorch)
12/06/2022 12:40:22 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 12:40:27 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=24, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 12:40:27 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 12:40:27 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 12:40:29 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 12:40:31 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 12:40:31 - INFO - __main__ -     Num examples = 6308
12/06/2022 12:40:31 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.42it/s]
12/06/2022 12:41:18 - INFO - __main__ -     Evaluation done in total 46.923539 secs (0.007439 sec per example)
12/06/2022 12:41:18 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 12:41:18 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 12:41:29 - INFO - __main__ -   Results:
12/06/2022 12:41:29 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.88259109311741), ('f1', 73.32615516038116), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 73.32615516038116), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 73.32615516038116), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.07539148904485), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.07539148904485), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.07539148904485), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.05934189514919), ('total', 494), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.05934189514919), ('HasAns_total', 494), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.05934189514919), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.502024291497975), ('f1', 73.86401038374305), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 73.86401038374305), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 73.86401038374305), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 57.69230769230769), ('f1', 73.52360654907538), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 73.52360654907538), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 73.52360654907538), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 57.48987854251012), ('f1', 73.16970109547889), ('total', 2470), ('HasAns_exact', 57.48987854251012), ('HasAns_f1', 73.16970109547889), ('HasAns_total', 2470), ('best_exact', 57.48987854251012), ('best_exact_thresh', 0.0), ('best_f1', 73.16970109547889), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.90662408185608), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.90662408185608), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.90662408185608), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 58.02469135802469), ('f1', 72.89720082683125), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 72.89720082683125), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 72.89720082683125), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 59.5679012345679), ('f1', 75.01254976394475), ('total', 324), ('HasAns_exact', 59.5679012345679), ('HasAns_f1', 75.01254976394475), ('HasAns_total', 324), ('best_exact', 59.5679012345679), ('best_exact_thresh', 0.0), ('best_f1', 75.01254976394475), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 58.641975308641975), ('f1', 73.82167490347925), ('total', 324), ('HasAns_exact', 58.641975308641975), ('HasAns_f1', 73.82167490347925), ('HasAns_total', 324), ('best_exact', 58.641975308641975), ('best_exact_thresh', 0.0), ('best_f1', 73.82167490347925), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 58.333333333333336), ('f1', 73.65951239402774), ('total', 1296), ('HasAns_exact', 58.333333333333336), ('HasAns_f1', 73.65951239402774), ('HasAns_total', 1296), ('best_exact', 58.333333333333336), ('best_exact_thresh', 0.0), ('best_f1', 73.65951239402774), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.1), ('f1', 72.12308248610057), ('total', 1000), ('HasAns_exact', 64.1), ('HasAns_f1', 72.12308248610057), ('HasAns_total', 1000), ('best_exact', 64.1), ('best_exact_thresh', 0.0), ('best_f1', 72.12308248610057), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.9), ('f1', 71.01441512112982), ('total', 1000), ('HasAns_exact', 62.9), ('HasAns_f1', 71.01441512112982), ('HasAns_total', 1000), ('best_exact', 62.9), ('best_exact_thresh', 0.0), ('best_f1', 71.01441512112982), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.5), ('f1', 71.56874880361526), ('total', 2000), ('HasAns_exact', 63.5), ('HasAns_f1', 71.56874880361526), ('HasAns_total', 2000), ('best_exact', 63.5), ('best_exact_thresh', 0.0), ('best_f1', 71.56874880361526), ('best_f1_thresh', 0.0)])
12/06/2022 12:41:29 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.764134582032604), ('f1', 72.7244861907251), ('total', 5766), ('HasAns_exact', 59.764134582032604), ('HasAns_f1', 72.7244861907251), ('HasAns_total', 5766), ('best_exact', 59.764134582032604), ('best_exact_thresh', 0.0), ('best_f1', 72.7244861907251), ('best_f1_thresh', 0.0)])
WARNING - You've set a doc stride which may be superior to the document length in some examples. This could result in errors when building features from the examples. Please reduce the doc stride or increase the maximum length to ensure the features are correctly built.
12/06/2022 12:41:30 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-multilingual-uncased and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/06/2022 12:41:35 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=False, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=184, max_steps=-1, model_name_or_path='bert-base-multilingual-uncased', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output/', overwrite_cache=True, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=32, predict_file=None, save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file='data/dialqa-train.json', train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 12:41:35 - INFO - __main__ -   Creating features from dataset file at .
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:06<00:00, 7961.74it/s]
convert squad examples to features:   0%|                                                                                                                                                                                                                                                           | 0/48063 [00:00<?, ?it/s]/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/tokenization_utils_base.py:1374: FutureWarning: The `max_len` attribute has been deprecated and will be removed in a future version, use `model_max_length` instead.
  FutureWarning,
convert squad examples to features:  25%|███████████████████████████████████████████████████████████▍                                                                                                                                                                                  | 12001/48063 [00:56<02:39, 226.71it/s]Could not find answer: 'датируется' vs. '1969'
convert squad examples to features:  47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 22433/48063 [01:44<02:01, 211.16it/s]Could not find answer: 'ja' vs. '36'
convert squad examples to features:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                               | 35233/48063 [02:42<00:54, 234.64it/s]Could not find answer: '10.02.58' vs. '58 г'
convert squad examples to features:  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 41345/48063 [03:12<00:37, 180.38it/s]Could not find answer: 'было' vs. '13'
convert squad examples to features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [03:42<00:00, 215.83it/s]
add example index and unique id: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48063/48063 [00:00<00:00, 898535.06it/s]
12/06/2022 12:45:25 - INFO - __main__ -   Saving features into cached file ./cached_train_bert-base-multilingual-uncased_184
12/06/2022 12:45:47 - INFO - __main__ -   ***** Running training *****
12/06/2022 12:45:47 - INFO - __main__ -     Num examples = 75700
12/06/2022 12:45:47 - INFO - __main__ -     Num Epochs = 3
12/06/2022 12:45:47 - INFO - __main__ -     Instantaneous batch size per GPU = 32
12/06/2022 12:45:47 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
12/06/2022 12:45:47 - INFO - __main__ -     Gradient Accumulation steps = 1
12/06/2022 12:45:47 - INFO - __main__ -     Total optimization steps = 7098
Iteration:   0%|                                                                                                                                                                                                                                                                                     | 0/2366 [00:00<?, ?it/s]
Epoch:   0%|                                                                                                                                                                                                                                                                                            | 0/3 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "src/run_squad.py", line 856, in <module>
    main()
  File "src/run_squad.py", line 797, in main
    global_step, tr_loss = train(args, train_dataset, model, tokenizer)
  File "src/run_squad.py", line 202, in train
    outputs = model(**inputs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 1612, in forward
    return_dict=return_dict,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 841, in forward
    return_dict=return_dict,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 482, in forward
    output_attentions,
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 423, in forward
    self.feed_forward_chunk, self.chunk_size_feed_forward, self.seq_len_dim, attention_output
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_utils.py", line 1696, in apply_chunking_to_forward
    return forward_fn(*input_tensors)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 429, in feed_forward_chunk
    intermediate_output = self.intermediate(attention_output)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/transformers/modeling_bert.py", line 357, in forward
    hidden_states = self.intermediate_act_fn(hidden_states)
  File "/home/pankaj/miniconda3/envs/py3/lib/python3.7/site-packages/torch/nn/functional.py", line 1459, in gelu
    return torch._C._nn.gelu(input)
RuntimeError: CUDA out of memory. Tried to allocate 70.00 MiB (GPU 0; 7.77 GiB total capacity; 5.89 GiB already allocated; 19.62 MiB free; 5.95 GiB reserved in total by PyTorch)
12/06/2022 12:45:48 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
12/06/2022 12:45:53 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, cache_dir='/scratch/nrajabi/NLP_A3', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=False, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name_or_path='/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output', model_type='bert', n_best_size=20, n_gpu=1, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='outputs/aug-mbert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=16, per_gpu_train_batch_size=32, predict_file='data/dialqa-dev-aug.json', save_steps=500, seed=42, server_ip='', server_port='', threads=1, tokenizer_name='', train_file=None, train_files=None, verbose_logging=False, version_2_with_negative=False, warmup_steps=0, weight_decay=0.0)
12/06/2022 12:45:53 - INFO - __main__ -   Loading checkpoint /media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output for evaluation
12/06/2022 12:45:53 - INFO - __main__ -   Evaluate the following checkpoints: ['/media/pankaj/77b908cd-def5-4c1e-9be0-0a0a117da625/home/pankaj/Study/NLP/train_cache_output']
12/06/2022 12:45:55 - INFO - __main__ -   Loading features from cached file ./cached_dev_train_cache_output_384
12/06/2022 12:45:57 - INFO - __main__ -   ***** Running evaluation  *****
12/06/2022 12:45:57 - INFO - __main__ -     Num examples = 6308
12/06/2022 12:45:57 - INFO - __main__ -     Batch size = 16
Evaluating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 395/395 [00:46<00:00,  8.41it/s]
12/06/2022 12:46:44 - INFO - __main__ -     Evaluation done in total 46.943787 secs (0.007442 sec per example)
12/06/2022 12:46:44 - INFO - squad_metrics -   Writing predictions to: outputs/aug-mbert/predictions_.json
12/06/2022 12:46:44 - INFO - squad_metrics -   Writing nbest to: outputs/aug-mbert/nbest_predictions_.json
12/06/2022 12:46:55 - INFO - __main__ -   Results:
12/06/2022 12:46:55 - INFO - __main__ -   english--nga: 
OrderedDict([('exact', 56.88259109311741), ('f1', 73.32615516038116), ('total', 494), ('HasAns_exact', 56.88259109311741), ('HasAns_f1', 73.32615516038116), ('HasAns_total', 494), ('best_exact', 56.88259109311741), ('best_exact_thresh', 0.0), ('best_f1', 73.32615516038116), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   english--usa: 
OrderedDict([('exact', 58.502024291497975), ('f1', 74.07539148904485), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 74.07539148904485), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 74.07539148904485), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   english--ind_s: 
OrderedDict([('exact', 55.87044534412956), ('f1', 71.05934189514919), ('total', 494), ('HasAns_exact', 55.87044534412956), ('HasAns_f1', 71.05934189514919), ('HasAns_total', 494), ('best_exact', 55.87044534412956), ('best_exact_thresh', 0.0), ('best_f1', 71.05934189514919), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   english--aus: 
OrderedDict([('exact', 58.502024291497975), ('f1', 73.86401038374305), ('total', 494), ('HasAns_exact', 58.502024291497975), ('HasAns_f1', 73.86401038374305), ('HasAns_total', 494), ('best_exact', 58.502024291497975), ('best_exact_thresh', 0.0), ('best_f1', 73.86401038374305), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   english--phl: 
OrderedDict([('exact', 57.69230769230769), ('f1', 73.52360654907538), ('total', 494), ('HasAns_exact', 57.69230769230769), ('HasAns_f1', 73.52360654907538), ('HasAns_total', 494), ('best_exact', 57.69230769230769), ('best_exact_thresh', 0.0), ('best_f1', 73.52360654907538), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   english-total: 
OrderedDict([('exact', 57.48987854251012), ('f1', 73.16970109547889), ('total', 2470), ('HasAns_exact', 57.48987854251012), ('HasAns_f1', 73.16970109547889), ('HasAns_total', 2470), ('best_exact', 57.48987854251012), ('best_exact_thresh', 0.0), ('best_f1', 73.16970109547889), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   arabic--dza: 
OrderedDict([('exact', 57.098765432098766), ('f1', 72.90662408185608), ('total', 324), ('HasAns_exact', 57.098765432098766), ('HasAns_f1', 72.90662408185608), ('HasAns_total', 324), ('best_exact', 57.098765432098766), ('best_exact_thresh', 0.0), ('best_f1', 72.90662408185608), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   arabic--egy: 
OrderedDict([('exact', 58.02469135802469), ('f1', 72.89720082683125), ('total', 324), ('HasAns_exact', 58.02469135802469), ('HasAns_f1', 72.89720082683125), ('HasAns_total', 324), ('best_exact', 58.02469135802469), ('best_exact_thresh', 0.0), ('best_f1', 72.89720082683125), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   arabic--jor: 
OrderedDict([('exact', 59.5679012345679), ('f1', 75.01254976394475), ('total', 324), ('HasAns_exact', 59.5679012345679), ('HasAns_f1', 75.01254976394475), ('HasAns_total', 324), ('best_exact', 59.5679012345679), ('best_exact_thresh', 0.0), ('best_f1', 75.01254976394475), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   arabic--tun: 
OrderedDict([('exact', 58.641975308641975), ('f1', 73.82167490347925), ('total', 324), ('HasAns_exact', 58.641975308641975), ('HasAns_f1', 73.82167490347925), ('HasAns_total', 324), ('best_exact', 58.641975308641975), ('best_exact_thresh', 0.0), ('best_f1', 73.82167490347925), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   arabic-total: 
OrderedDict([('exact', 58.333333333333336), ('f1', 73.65951239402774), ('total', 1296), ('HasAns_exact', 58.333333333333336), ('HasAns_f1', 73.65951239402774), ('HasAns_total', 1296), ('best_exact', 58.333333333333336), ('best_exact_thresh', 0.0), ('best_f1', 73.65951239402774), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   swahili--kenya: 
OrderedDict([('exact', 64.1), ('f1', 72.12308248610057), ('total', 1000), ('HasAns_exact', 64.1), ('HasAns_f1', 72.12308248610057), ('HasAns_total', 1000), ('best_exact', 64.1), ('best_exact_thresh', 0.0), ('best_f1', 72.12308248610057), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   swahili--tanzania: 
OrderedDict([('exact', 62.9), ('f1', 71.01441512112982), ('total', 1000), ('HasAns_exact', 62.9), ('HasAns_f1', 71.01441512112982), ('HasAns_total', 1000), ('best_exact', 62.9), ('best_exact_thresh', 0.0), ('best_f1', 71.01441512112982), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   swahili-total: 
OrderedDict([('exact', 63.5), ('f1', 71.56874880361526), ('total', 2000), ('HasAns_exact', 63.5), ('HasAns_f1', 71.56874880361526), ('HasAns_total', 2000), ('best_exact', 63.5), ('best_exact_thresh', 0.0), ('best_f1', 71.56874880361526), ('best_f1_thresh', 0.0)])
12/06/2022 12:46:55 - INFO - __main__ -   all_language: 
OrderedDict([('exact', 59.764134582032604), ('f1', 72.7244861907251), ('total', 5766), ('HasAns_exact', 59.764134582032604), ('HasAns_f1', 72.7244861907251), ('HasAns_total', 5766), ('best_exact', 59.764134582032604), ('best_exact_thresh', 0.0), ('best_f1', 72.7244861907251), ('best_f1_thresh', 0.0)])
(py3) pankaj@mint:~/study/nlp/DialQA$ 
